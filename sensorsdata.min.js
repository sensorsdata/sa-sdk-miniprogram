var _={};var sa={};sa.para=require("./sensorsdata_conf.js");if(!sa.para.openid_url){sa.para.openid_url=sa.para.server_url.replace(/\/sa(\.gif){0,1}/,"/mp_login")}var ArrayProto=Array.prototype,FuncProto=Function.prototype,ObjProto=Object.prototype,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,LIB_VERSION="1.9.5",LIB_NAME="MiniProgram";var source_channel_standard="utm_source utm_medium utm_campaign utm_content utm_term";var mp_scene={1001:"发现栏小程序主入口，“最近使用”列表",1005:"顶部搜索框的搜索结果页",1006:"发现栏小程序主入口搜索框的搜索结果页",1007:"单人聊天会话中的小程序消息卡片",1008:"群聊会话中的小程序消息卡片",1011:"扫描二维码",1012:"长按图片识别二维码",1013:"手机相册选取二维码",1014:"小程序模版消息",1017:"前往体验版的入口页",1019:"微信钱包",1020:"公众号 profile 页相关小程序列表",1022:"聊天顶部置顶小程序入口",1023:"安卓系统桌面图标",1024:"小程序 profile 页",1025:"扫描一维码",1026:"附近小程序列表",1027:"顶部搜索框搜索结果页“使用过的小程序”列表",1028:"我的卡包",1029:"卡券详情页",1030:"自动化测试下打开小程序",1031:"长按图片识别一维码",1032:"手机相册选取一维码",1034:"微信支付完成页",1035:"公众号自定义菜单",1036:"App 分享消息卡片",1037:"小程序打开小程序",1038:"从另一个小程序返回",1039:"摇电视",1042:"添加好友搜索框的搜索结果页",1043:"公众号模板消息",1044:"带 shareTicket 的小程序消息卡片（详情)",1045:"朋友圈广告",1046:"朋友圈广告详情页",1047:"扫描小程序码",1048:"长按图片识别小程序码",1049:"手机相册选取小程序码",1052:"卡券的适用门店列表",1053:"搜一搜的结果页",1054:"顶部搜索框小程序快捷入口",1056:"音乐播放器菜单",1057:"钱包中的银行卡详情页",1058:"公众号文章",1059:"体验版小程序绑定邀请页",1064:"微信连Wi-Fi状态栏",1067:"公众号文章广告",1068:"附近小程序列表广告",1069:"移动应用",1071:"钱包中的银行卡列表页",1072:"二维码收款页面",1073:"客服消息列表下发的小程序消息卡片",1074:"公众号会话下发的小程序消息卡片",1077:"摇周边",1078:"连Wi-Fi成功页",1079:"微信游戏中心",1081:"客服消息下发的文字链",1082:"公众号会话下发的文字链",1084:"朋友圈广告原生页",1089:"微信聊天主界面下拉",1090:"长按小程序右上角菜单唤出最近使用历史",1091:"公众号文章商品卡片",1092:"城市服务入口",1095:"小程序广告组件",1096:"聊天记录",1097:"微信支付签约页",1099:"页面内嵌插件",1102:"公众号 profile 页服务预览",1103:"发现栏小程序主入口，“我的小程序”列表",1104:"微信聊天主界面下拉，“我的小程序”栏"};var sa_referrer="直接打开";var mpshow_time=null;var share_depth=0;var share_distinct_id="";var is_first_launch=false;sa.lib_version=LIB_VERSION;var logger=typeof logger==="object"?logger:{};logger.info=function(){if(sa.para.show_log){if(typeof console==="object"&&console.log){try{return console.log.apply(console,arguments)}catch(e){console.log(arguments[0])}}}};(function(){var nativeBind=FuncProto.bind,nativeForEach=ArrayProto.forEach,nativeIndexOf=ArrayProto.indexOf,nativeIsArray=Array.isArray,breaker={};var each=_.each=function(obj,iterator,context){if(obj==null){return false}if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else if(obj.length===+obj.length){for(var i=0,l=obj.length;i<l;i++){if(i in obj&&iterator.call(context,obj[i],i,obj)===breaker){return false}}}else{for(var key in obj){if(hasOwnProperty.call(obj,key)){if(iterator.call(context,obj[key],key,obj)===breaker){return false}}}}};_.logger=logger;_.extend=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(source[prop]!==void 0){obj[prop]=source[prop]}}});return obj};_.extend2Lev=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(source[prop]!==void 0){if(_.isObject(source[prop])&&_.isObject(obj[prop])){_.extend(obj[prop],source[prop])}else{obj[prop]=source[prop]}}}});return obj};_.coverExtend=function(obj){each(slice.call(arguments,1),function(source){for(var prop in source){if(source[prop]!==void 0&&obj[prop]===void 0){obj[prop]=source[prop]}}});return obj};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isFunction=function(f){try{return/^\s*\bfunction\b/.test(f)}catch(x){return false}};_.isArguments=function(obj){return!!(obj&&hasOwnProperty.call(obj,"callee"))};_.toArray=function(iterable){if(!iterable){return[]}if(iterable.toArray){return iterable.toArray()}if(_.isArray(iterable)){return slice.call(iterable)}if(_.isArguments(iterable)){return slice.call(iterable)}return _.values(iterable)};_.values=function(obj){var results=[];if(obj==null){return results}each(obj,function(value){results[results.length]=value});return results};_.include=function(obj,target){var found=false;if(obj==null){return found}if(nativeIndexOf&&obj.indexOf===nativeIndexOf){return obj.indexOf(target)!=-1}each(obj,function(value){if(found||(found=value===target)){return breaker}});return found}})();_.trim=function(str){return str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};_.isObject=function(obj){return toString.call(obj)=="[object Object]"&&obj!=null};_.isEmptyObject=function(obj){if(_.isObject(obj)){for(var key in obj){if(hasOwnProperty.call(obj,key)){return false}}return true}return false};_.isUndefined=function(obj){return obj===void 0};_.isString=function(obj){return toString.call(obj)=="[object String]"};_.isDate=function(obj){return toString.call(obj)=="[object Date]"};_.isBoolean=function(obj){return toString.call(obj)=="[object Boolean]"};_.isNumber=function(obj){return toString.call(obj)=="[object Number]"&&/[\d\.]+/.test(String(obj))};_.isJSONString=function(str){try{JSON.parse(str)}catch(e){return false}return true};_.decodeURIComponent=function(val){var result="";try{result=decodeURIComponent(val)}catch(e){result=val}return result};_.encodeDates=function(obj){_.each(obj,function(v,k){if(_.isDate(v)){obj[k]=_.formatDate(v)}else if(_.isObject(v)){obj[k]=_.encodeDates(v)}});return obj};_.formatDate=function(d){function pad(n){return n<10?"0"+n:n}return d.getFullYear()+"-"+pad(d.getMonth()+1)+"-"+pad(d.getDate())+" "+pad(d.getHours())+":"+pad(d.getMinutes())+":"+pad(d.getSeconds())+"."+pad(d.getMilliseconds())};_.searchObjDate=function(o){if(_.isObject(o)){_.each(o,function(a,b){if(_.isObject(a)){_.searchObjDate(o[b])}else{if(_.isDate(a)){o[b]=_.formatDate(a)}}})}};_.formatString=function(str){if(str.length>sa.para.max_string_length){logger.info("字符串长度超过限制，已经做截取--"+str);return str.slice(0,sa.para.max_string_length)}else{return str}};_.searchObjString=function(o){if(_.isObject(o)){_.each(o,function(a,b){if(_.isObject(a)){_.searchObjString(o[b])}else{if(_.isString(a)){o[b]=_.formatString(a)}}})}};_.unique=function(ar){var temp,n=[],o={};for(var i=0;i<ar.length;i++){temp=ar[i];if(!(temp in o)){o[temp]=true;n.push(temp)}}return n};_.strip_sa_properties=function(p){if(!_.isObject(p)){return p}_.each(p,function(v,k){if(_.isArray(v)){var temp=[];_.each(v,function(arrv){if(_.isString(arrv)){temp.push(arrv)}else{logger.info("您的数据-",v,"的数组里的值必须是字符串,已经将其删除")}});if(temp.length!==0){p[k]=temp}else{delete p[k];logger.info("已经删除空的数组")}}if(!(_.isString(v)||_.isNumber(v)||_.isDate(v)||_.isBoolean(v)||_.isArray(v))){logger.info("您的数据-",v,"-格式不满足要求，我们已经将其删除");delete p[k]}});return p};_.strip_empty_properties=function(p){var ret={};_.each(p,function(v,k){if(v!=null){ret[k]=v}});return ret};_.utf8Encode=function(string){string=(string+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var utftext="",start,end;var stringl=0,n;start=end=0;stringl=string.length;for(n=0;n<stringl;n++){var c1=string.charCodeAt(n);var enc=null;if(c1<128){end++}else if(c1>127&&c1<2048){enc=String.fromCharCode(c1>>6|192,c1&63|128)}else{enc=String.fromCharCode(c1>>12|224,c1>>6&63|128,c1&63|128)}if(enc!==null){if(end>start){utftext+=string.substring(start,end)}utftext+=enc;start=end=n+1}}if(end>start){utftext+=string.substring(start,string.length)}return utftext};_.base64Encode=function(data){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,enc="",tmp_arr=[];if(!data){return data}data=_.utf8Encode(data);do{o1=data.charCodeAt(i++);o2=data.charCodeAt(i++);o3=data.charCodeAt(i++);bits=o1<<16|o2<<8|o3;h1=bits>>18&63;h2=bits>>12&63;h3=bits>>6&63;h4=bits&63;tmp_arr[ac++]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4)}while(i<data.length);enc=tmp_arr.join("");switch(data.length%3){case 1:enc=enc.slice(0,-2)+"==";break;case 2:enc=enc.slice(0,-1)+"=";break}return enc};_.getCurrentPath=function(){var url="未取到";try{var pages=getCurrentPages();var currentPage=pages[pages.length-1];url=currentPage.route}catch(e){logger.info(e)}return url};_.getQueryParam=function(url,param){var regexS="[\\?&]"+param+"=([^&#]*)",regex=new RegExp(regexS),results=regex.exec(url);if(results===null||results&&typeof results[1]!=="string"&&results[1].length){return""}else{return _.decodeURIComponent(results[1])}};sa.initialState={queue:[],isComplete:false,systemIsComplete:false,storeIsComplete:false,checkIsComplete:function(){if(this.systemIsComplete&&this.storeIsComplete){this.isComplete=true;if(this.queue.length>0){_.each(this.queue,function(content){sa[content[0]].apply(sa,slice.call(content[1]))});sa.queue=[]}}}};_.getPrefixUtm=function(utms,prefix,prefix_add){prefix=prefix||"";prefix_add=prefix_add||"_";if(!_.isObject(utms)){return{}}var $utms={},otherUtms={};for(var i in utms){if((" "+source_channel_standard+" ").indexOf(" "+i+" ")!==-1){$utms[prefix+i]=utms[i]}else{otherUtms[prefix_add+i]=utms[i]}}return{$utms:$utms,otherUtms:otherUtms}};_.convertObjToParam=function(obj){var arr=[];for(var i in obj){arr.push(i+"="+obj[i])}return arr.join("&")};_.getSource=function(url){if(_.isObject(url)){if(_.isEmptyObject(url)){return{}}else{for(var i in url){if((" "+source_channel_standard+" ").indexOf(" "+i+" ")===-1){delete url[i]}else{url[i]=url[i].replace("?","*")}}url=_.convertObjToParam(url);url="?"+url}}else{url=_.decodeURIComponent(url)}var campagin_w=source_channel_standard.split(" ");var campaign_keywords=source_channel_standard.split(" ");var kw="";var params={};url=url.split("?");if(url.length===2){url=url[1]}else{return{}}url="?"+url;if(_.isArray(sa.para.source_channel)&&sa.para.source_channel.length>0){campaign_keywords=campaign_keywords.concat(sa.para.source_channel);campaign_keywords=_.unique(campaign_keywords)}_.each(campaign_keywords,function(kwkey){kw=_.getQueryParam(url,kwkey);kw=_.decodeURIComponent(kw);if(kw.length){if(_.include(campagin_w,kwkey)){params[kwkey]=kw}}});return params};_.getObjFromQuery=function(str){var query=str.split("?");var arr=[];var obj={};if(query&&query[1]){_.each(query[1].split("&"),function(value){var arr=value.split("=");if(arr[0]&&arr[1]){obj[arr[0]]=arr[1]}})}else{return{}}return obj};_.getUtm=function(url,prefix1,prefix2){var utms=_.getSource(url);var pre1={};var pre2={};if(typeof prefix2==="undefined"&&prefix1){return{pre1:_.getPrefixUtm(utms,prefix1).$utms||{},pre2:{}}}else if(typeof prefix2!=="undefined"&&prefix1){return{pre1:_.getPrefixUtm(utms,prefix1).$utms||{},pre2:_.getPrefixUtm(utms,prefix2).$utms||{}}}else{return{pre1:{},pre2:{}}}};_.getMPScene=function(key){if(typeof key==="number"||typeof key==="string"&&key!==""){key=String(key);return mp_scene[key]||key}else{return"未取到值"}};_.getShareDepth=function(){if(typeof share_depth==="number"&&share_depth!==0){var current_id=sa.store.getDistinctId();var current_first_id=sa.store.getFirstId();var latest_id=share_distinct_id;if(latest_id&&(latest_id===current_id||latest_id===current_first_id)){return share_depth}else{return share_depth+1}}else{return 1}};_.setShareInfo=function(para,prop){var share={};if(para&&_.isObject(para.query)&&para.query.sampshare){share=_.decodeURIComponent(para.query.sampshare);if(_.isJSONString(share)){share=JSON.parse(share)}else{return{}}}else{return{}}var depth=share.d;var path=share.p;var id=share.i;if(typeof id==="string"){prop.$share_distinct_id=id;share_distinct_id=id}else{prop.$share_distinct_id="取值异常"}if(typeof depth==="number"){prop.$share_depth=depth;share_depth=depth}else{prop.$share_depth="取值异常"}if(typeof path==="string"){prop.$share_url_path=path}else{prop.$share_url_path="取值异常"}};_.getShareInfo=function(){return JSON.stringify({i:sa.store.getDistinctId()||"取值异常",p:_.getCurrentPath(),d:_.getShareDepth()})};_.setUtm=function(para,prop){var query={};if(para&&_.isObject(para.query)){query=_.extend({},para.query);var scene=query.scene;if(scene){if(scene.indexOf("?")!==-1){scene="?"+scene.replace(/\?/g,"")}else{scene="?"+scene}_.extend(query,_.getObjFromQuery(scene))}if(para.query.q){_.extend(query,_.getObjFromQuery(_.decodeURIComponent(para.query.q)))}}if(para&&_.isObject(para.referrerInfo)&&para.referrerInfo.extraData){var extraQuery={};if(_.isObject(para.referrerInfo.extraData)&&!_.isEmptyObject(para.referrerInfo.extraData)){extraQuery=para.referrerInfo.extraData}else if(_.isJSONString(para.referrerInfo.extraData)){extraQuery=JSON.parse(para.referrerInfo.extraData)}_.extend(query,extraQuery)}var utms=_.getUtm(query,"$","$latest_");_.extend(prop,utms.pre1);return utms};_.info={properties:{$lib:LIB_NAME,$lib_version:String(LIB_VERSION),$user_agent:"SensorsAnalytics MP SDK"},getSystem:function(){var e=this.properties;var that=this;function getNetwork(){wx.getNetworkType({success:function(t){e.$network_type=t["networkType"]},complete:getSystemInfo})}function getSystemInfo(){wx.getSystemInfo({success:function(t){e.$model=t["model"];e.$screen_width=Number(t["windowWidth"]);e.$screen_height=Number(t["windowHeight"]);e.$os=t["system"].split(" ")[0];e.$os_version=t["system"].split(" ")[1]},complete:function(){sa.initialState.systemIsComplete=true;sa.initialState.checkIsComplete()}})}getNetwork()}};sa._=_;sa.prepareData=function(p,callback){var data={distinct_id:this.store.getDistinctId(),lib:{$lib:LIB_NAME,$lib_method:"code",$lib_version:String(LIB_VERSION)},properties:{}};_.extend(data,p);if(_.isObject(p.properties)&&!_.isEmptyObject(p.properties)){_.extend(data.properties,p.properties)}if(!p.type||p.type.slice(0,7)!=="profile"){data.properties=_.extend({},_.info.properties,sa.store.getProps(),data.properties);if(typeof sa.store._state==="object"&&typeof sa.store._state.first_visit_day_time==="number"&&sa.store._state.first_visit_day_time>(new Date).getTime()){data.properties.$is_first_day=true}else{data.properties.$is_first_day=false}}if(data.properties.$time&&_.isDate(data.properties.$time)){data.time=data.properties.$time*1;delete data.properties.$time}else{if(sa.para.use_client_time){data.time=new Date*1}}_.searchObjDate(data);_.searchObjString(data);sa.send(data,callback)};sa.store={storageInfo:null,getUUID:function(){return""+Date.now()+"-"+Math.floor(1e7*Math.random())+"-"+Math.random().toString(16).replace(".","")+"-"+String(Math.random()*31242).replace(".","").slice(0,8)},getStorage:function(){if(this.storageInfo){return this.storageInfo}else{this.storageInfo=wx.getStorageSync("sensorsdata2015_wechat")||"";return this.storageInfo}},_state:{},toState:function(ds){var state=null;if(_.isJSONString(ds)){state=JSON.parse(ds);if(state.distinct_id){this._state=state}else{this.set("distinct_id",this.getUUID())}}else if(_.isObject(ds)){state=ds;if(state.distinct_id){this._state=state}else{this.set("distinct_id",this.getUUID())}}else{this.set("distinct_id",this.getUUID())}},getFirstId:function(){return this._state.first_id},getDistinctId:function(){return this._state.distinct_id},getProps:function(){return this._state.props||{}},setProps:function(newp,isCover){var props=this._state.props||{};if(!isCover){_.extend(props,newp);this.set("props",props)}else{this.set("props",newp)}},set:function(name,value){var obj={};if(typeof name==="string"){obj[name]=value}else if(typeof name==="object"){obj=name}this._state=this._state||{};for(var i in obj){this._state[i]=obj[i]}this.save()},change:function(name,value){this._state[name]=value},save:function(){wx.setStorageSync("sensorsdata2015_wechat",this._state)},init:function(){var info=this.getStorage();if(info){this.toState(info)}else{is_first_launch=true;var time=new Date;var visit_time=time.getTime();time.setHours(23);time.setMinutes(59);time.setSeconds(60);this.set({distinct_id:this.getUUID(),first_visit_time:visit_time,first_visit_day_time:time.getTime()})}}};sa.setProfile=function(p,c){sa.prepareData({type:"profile_set",properties:p},c)};sa.setOnceProfile=function(p,c){sa.prepareData({type:"profile_set_once",properties:p},c)};sa.track=function(e,p,c){this.prepareData({type:"track",event:e,properties:p},c)};sa.identify=function(id,isSave){if(typeof id==="number"){id=String(id)}else if(typeof id!=="string"){return false}var firstId=sa.store.getFirstId();if(isSave===true){if(firstId){sa.store.set("first_id",id)}else{sa.store.set("distinct_id",id)}}else{if(firstId){sa.store.change("first_id",id)}else{sa.store.change("distinct_id",id)}}};sa.trackSignup=function(id,e,p,c){sa.prepareData({original_id:sa.store.getFirstId()||sa.store.getDistinctId(),distinct_id:id,type:"track_signup",event:e,properties:p},c);sa.store.set("distinct_id",id)};sa.registerApp=function(obj){if(_.isObject(obj)&&!_.isEmptyObject(obj)){_.info.properties=_.extend(_.info.properties,obj)}};sa.register=function(obj){if(_.isObject(obj)&&!_.isEmptyObject(obj)){sa.store.setProps(obj)}};sa.clearAllRegister=function(){sa.store.setProps({},true)};sa.login=function(id){var firstId=sa.store.getFirstId();var distinctId=sa.store.getDistinctId();if(id!==distinctId){if(firstId){sa.trackSignup(id,"$SignUp")}else{sa.store.set("first_id",distinctId);sa.trackSignup(id,"$SignUp")}}};sa.openid={getRequest:function(callback){wx.login({success:function(res){if(res.code&&sa.para.appid&&sa.para.openid_url){wx.request({url:sa.para.openid_url+"&code="+res.code+"&appid="+sa.para.appid,method:"GET",complete:function(res2){if(_.isObject(res2)&&_.isObject(res2.data)&&res2.data.openid){callback(res2.data.openid)}else{callback()}}})}else{callback()}}})},getWXStorage:function(){var storageInfo=sa.store.getStorage();if(storageInfo&&_.isObject(storageInfo)){return storageInfo.openid}},getOpenid:function(callback){if(!sa.para.appid){callback();return false}var storageId=this.getWXStorage();if(storageId){callback(storageId)}else{this.getRequest(function(openid){if(openid){callback(openid)}})}}};sa.initial=function(){this._.info.getSystem();this.store.init();if(_.isObject(this.para.register)){_.info.properties=_.extend(_.info.properties,this.para.register)}};sa.init=function(){sa.initialState.storeIsComplete=true;sa.initialState.checkIsComplete()};sa.getPresetProperties=function(){if(_.info&&_.info.properties&&_.info.properties.$lib&&_.info.properties.$user_agent){delete _.info.properties.$lib;delete _.info.properties.$user_agent;return _.extend({$url_path:_.getCurrentPath()},_.info.properties,sa.store.getProps())}else{return{}}};_.autoExeQueue=function(){var queue={items:[],enqueue:function(val){this.items.push(val);this.start()},dequeue:function(){return this.items.shift()},getCurrentItem:function(){return this.items[0]},isRun:false,start:function(){if(this.items.length>0&&!this.isRun){this.isRun=true;this.getCurrentItem().start()}},close:function(){this.dequeue();this.isRun=false;this.start()}};return queue};sa.requestQueue=function(para){this.url=para.url};sa.requestQueue.prototype.isEnd=function(){if(!this.received){this.received=true;this.close()}};sa.requestQueue.prototype.start=function(){var me=this;setTimeout(function(){me.isEnd()},600);wx.request({url:this.url,method:"GET",complete:function(){me.isEnd()}})};sa.dataQueue=_.autoExeQueue();sa.send=function(t){var url="";t._nocache=(String(Math.random())+String(Math.random())+String(Math.random())).slice(2,15);logger.info(t);t=JSON.stringify(t);if(sa.para.server_url.indexOf("?")!==-1){url=sa.para.server_url+"&data="+encodeURIComponent(_.base64Encode(t))}else{url=sa.para.server_url+"?data="+encodeURIComponent(_.base64Encode(t))}var instance=new sa.requestQueue({url:url});instance.close=function(){sa.dataQueue.close()};sa.dataQueue.enqueue(instance)};sa.autoTrackCustom=function(api,prop,event){var temp=sa.para.autoTrack[api];var tempFunc="";if(sa.para.autoTrack&&temp){if(typeof temp==="function"){tempFunc=temp();if(_.isObject(tempFunc)){_.extend(prop,tempFunc)}}else if(_.isObject(temp)){_.extend(prop,temp);sa.para.autoTrack[api]=true}sa.track(event,prop)}};sa.setOpenid=function(openid,isCover){sa.store.set("openid",openid);if(isCover){sa.store.set("distinct_id",openid)}else{sa.identify(openid,true)}};sa.initWithOpenid=function(options){options=options||{};sa.openid.getOpenid(function(openid){if(openid){sa.setOpenid(openid,options.isCoverLogin)}sa.init()})};_.each(["setProfile","setOnceProfile","track","register","clearAllRegister","autoTrackCustom","registerApp"],function(method){var temp=sa[method];sa[method]=function(){if(sa.initialState.isComplete){temp.apply(sa,arguments)}else{sa.initialState.queue.push([method,arguments])}}});function e(t,n,o){if(t[n]){var e=t[n];t[n]=function(t){e.call(this,t);o.call(this,t,n)}}else{t[n]=function(t){o.call(this,t,n)}}}function appLaunch(para){this[sa.para.name]=sa;var prop={};if(para&&para.path){prop.$url_path=para.path}_.setShareInfo(para,prop);var utms=_.setUtm(para,prop);if(is_first_launch){prop.$is_first_time=true;if(!_.isEmptyObject(utms.pre1)){sa.setOnceProfile(utms.pre1)}}else{prop.$is_first_time=false}if(!_.isEmptyObject(utms.pre2)){sa.registerApp(utms.pre2)}prop.$scene=_.getMPScene(para.scene);sa.registerApp({$latest_scene:prop.$scene});if(sa.para.autoTrack&&sa.para.autoTrack.appLaunch){sa.autoTrackCustom("appLaunch",prop,"$MPLaunch")}}function appShow(para){var prop={};mpshow_time=(new Date).getTime();if(para&&para.path){prop.$url_path=para.path}_.setShareInfo(para,prop);var utms=_.setUtm(para,prop);if(!_.isEmptyObject(utms.pre2)){sa.registerApp(utms.pre2)}prop.$scene=_.getMPScene(para.scene);sa.registerApp({$latest_scene:prop.$scene});if(sa.para.autoTrack&&sa.para.autoTrack.appShow){sa.autoTrackCustom("appShow",prop,"$MPShow")}}function appHide(){var current_time=(new Date).getTime();var prop={};prop.$url_path=_.getCurrentPath();if(mpshow_time&&current_time-mpshow_time>0&&(current_time-mpshow_time)/36e5<24){prop.event_duration=(current_time-mpshow_time)/1e3}if(sa.para.autoTrack&&sa.para.autoTrack.appHide){sa.autoTrackCustom("appHide",prop,"$MPHide")}}function appError(){}function appUnLaunch(){}var p=App;App=function(t){e(t,"onLaunch",appLaunch);e(t,"onShow",appShow);e(t,"onHide",appHide);p(t)};function pageOnunload(n,e){}function pageOnHide(){}function pageOnReady(){}function pageOnPullDownRefresh(){}function pageOnReachBottom(){}function pageOnShareAppMessage(n,e){}var oldPage=Page;Page=function(option){e(option,"onLoad",function(para){if(para&&_.isObject(para)){var query=_.extend({},para);if(para.q){_.extend(query,_.getObjFromQuery(_.decodeURIComponent(para.q)))}var utms=_.getUtm(query,"$","$latest_");this.sensors_mp_load_utm=utms.pre1}});e(option,"onShow",function(){var router="系统没有取到值";if(typeof this==="object"){if(typeof this.route==="string"){router=this.route}else if(typeof this.__route__==="string"){router=this.__route__}}var prop={};prop.$referrer=sa_referrer;prop.$url_path=router;if(this.sensors_mp_load_utm){_.extend(prop,this.sensors_mp_load_utm);this.sensors_mp_load_utm=null}if(sa.para.onshow){sa.para.onshow(sa,router,this)}else{sa.autoTrackCustom("pageShow",prop,"$MPViewScreen")}sa_referrer=router});if(typeof option.onShareAppMessage==="function"){var oldMessage=option.onShareAppMessage;option.onShareAppMessage=function(){if(sa.para.autoTrack&&sa.para.autoTrack.pageShare){sa.autoTrackCustom("pageShare",{$url_path:_.getCurrentPath(),$share_depth:_.getShareDepth()},"$MPShare")}var oldValue=oldMessage.apply(this,arguments);if(sa.para.allow_amend_share_path&&typeof oldValue.path==="string"&&oldValue.path.indexOf("/")!==-1){if(oldValue.path.indexOf("?")===-1){oldValue.path=oldValue.path+"?"}else{if(oldValue.path.slice(-1)!=="&"){oldValue.path=oldValue.path+"&"}}oldValue.path=oldValue.path+"sampshare="+encodeURIComponent(_.getShareInfo())}return oldValue}}oldPage.apply(this,arguments)};sa.initial();module.exports=sa;