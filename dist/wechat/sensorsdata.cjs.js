"use strict";var sa={},saPara={name:"sensors",server_url:"",send_timeout:1e3,show_log:!1,login_id_key:"$identity_login_id",allow_amend_share_path:!0,max_string_length:5e3,datasend_timeout:3e3,source_channel:[],autoTrack:{appLaunch:!0,appShow:!0,appHide:!0,pageShow:!0,pageShare:!0,mpClick:!1,mpFavorite:!0,pageLeave:!1},autotrack_exclude_page:{pageShow:[],pageLeave:[]},is_persistent_save:{share:!1,utm:!1},preset_properties:{url_path:!0},preset_events:{moments_page:!1,defer_track:!1,share_info_use_string:!1},batch_send:!0,sdk_id:"",storage_store_key:"sensorsdata2015_wechat",storage_prepare_data_key:"sensors_mp_prepare_data"};function log(){if(saPara.show_log&&"object"==typeof console&&console.log)try{return console.log.apply(console,arguments)}catch(e){console.log(arguments[0])}}var nativeIsArray=Array.isArray,ObjProto=Object.prototype,ArrayProto=Array.prototype,nativeForEach=ArrayProto.forEach,nativeIndexOf=ArrayProto.indexOf,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,slice=ArrayProto.slice;function each(e,t,i){if(null==e)return!1;var a={};if(nativeForEach&&e.forEach===nativeForEach)e.forEach(t,i);else if(e.length===+e.length){for(var r=0,n=e.length;r<n;r++)if(r in e&&t.call(i,e[r],r,e)===a)return!1}else for(var s in e)if(hasOwnProperty.call(e,s)&&t.call(i,e[s],s,e)===a)return!1}function isObject(e){return null!=e&&"[object Object]"==toString.call(e)}var getRandomBasic=function(){var e=(new Date).getTime();return function(t){return Math.ceil((e=(9301*e+49297)%233280)/233280*t)}}();function getRandom(){if("function"==typeof Uint32Array){var e="";if("undefined"!=typeof crypto?e=crypto:"undefined"!=typeof msCrypto&&(e=msCrypto),isObject(e)&&e.getRandomValues){var t=new Uint32Array(1);return e.getRandomValues(t)[0]/Math.pow(2,32)}}return getRandomBasic(1e19)/1e19}function extend(e){return each(slice.call(arguments,1),function(t){for(var i in t)void 0!==t[i]&&(e[i]=t[i])}),e}function extend2Lev(e){return each(slice.call(arguments,1),function(t){for(var i in t)void 0!==t[i]&&null!==t[i]&&(isObject(t[i])&&isObject(e[i])?extend(e[i],t[i]):e[i]=t[i])}),e}function coverExtend(e){return each(slice.call(arguments,1),function(t){for(var i in t)void 0!==t[i]&&void 0===e[i]&&(e[i]=t[i])}),e}var isArray=nativeIsArray||function(e){return"[object Array]"===toString.call(e)};function isFunction(e){if(!e)return!1;var t=Object.prototype.toString.call(e);return"[object Function]"==t||"[object AsyncFunction]"==t}function isArguments(e){return!(!e||!hasOwnProperty.call(e,"callee"))}function toArray(e){return e?e.toArray?e.toArray():isArray(e)?slice.call(e):isArguments(e)?slice.call(e):values(e):[]}function values(e){var t=[];return null==e?t:(each(e,function(e){t[t.length]=e}),t)}function include(e,t){var i=!1;return null==e?i:nativeIndexOf&&e.indexOf===nativeIndexOf?-1!=e.indexOf(t):(each(e,function(e){if(i||(i=e===t))return{}}),i)}function trim(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function isEmptyObject(e){if(isObject(e)){for(var t in e)if(hasOwnProperty.call(e,t))return!1;return!0}return!1}function deepCopy(e){var t={};return function e(t,i){for(var a in i){var r=i[a];isArray(r)?(t[a]=[],e(t[a],r)):isObject(r)?(t[a]={},e(t[a],r)):t[a]=r}}(t,e),t}function isUndefined(e){return void 0===e}function isString(e){return"[object String]"==toString.call(e)}function isDate(e){return"[object Date]"==toString.call(e)}function isBoolean(e){return"[object Boolean]"==toString.call(e)}function isNumber(e){return"[object Number]"==toString.call(e)&&/[\d\\.]+/.test(String(e))}function isJSONString(e){try{JSON.parse(e)}catch(e){return!1}return!0}var isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},isSafeInteger=Number.isSafeInteger||function(e){return isInteger(e)&&Math.abs(e)<=Math.pow(2,53)-1},urlSafeBase64={ENC:{"+":"-","/":"_","=":"."},DEC:{"-":"+",_:"/",".":"="},encode:function(e){return e.replace(/[+\/=]/g,function(e){return urlSafeBase64.ENC[e]})},decode:function(e){return e.replace(/[-_.]/g,function(e){return urlSafeBase64.DEC[e]})},trim:function(e){return e.replace(/[.=]{1,2}$/,"")},isBase64:function(e){return/^[A-Za-z0-9+\/]*[=]{0,2}$/.test(e)},isUrlSafeBase64:function(e){return/^[A-Za-z0-9_-]*[.]{0,2}$/.test(e)}},SOURCE_CHANNEL_STANDARD="utm_source utm_medium utm_campaign utm_content utm_term",LATEST_SOURCE_CHANNEL=["$latest_utm_source","$latest_utm_medium","$latest_utm_campaign","$latest_utm_content","$latest_utm_term","$latest_sa_utm"],LATEST_SHARE_INFO=["$latest_share_distinct_id","$latest_share_url_path","$latest_share_depth","$latest_share_method"],SHARE_INFO_KEY=["sensors_share_d","sensors_share_p","sensors_share_i","sensors_share_m"],MP_FILTER_HOOK={data:1,onLoad:1,onShow:1,onReady:1,onPullDownRefresh:1,onShareAppMessage:1,onShareTimeline:1,onReachBottom:1,onPageScroll:1,onResize:1,onTabItemTap:1,onHide:1,onUnload:1},IDENTITY_KEY={EMAIL:"$identity_email",MOBILE:"$identity_mobile",LOGIN:"$identity_login_id"},LIB_VERSION="1.21.5",LIB_NAME="MiniProgram",meta={init_status:!1,life_state:{app_launched:!1},plugin:{init_list:[],uninitialized_list:[]},privacy:{enable_data_collect:!1},initialState:{queue:[],isComplete:!1},preset_properties:{$lib:LIB_NAME,$lib_version:LIB_VERSION},promise_list:[],query_share_depth:0,page_show_time:Date.now(),mp_show_time:null,share_distinct_id:"",share_method:"",current_scene:"",is_first_launch:!1,wx_sdk_version:"",global_title:{},page_route_map:[]};function getAppInfoSync(){if(wx.getAccountInfoSync){var e=wx.getAccountInfoSync(),t=e&&e.miniProgram?e.miniProgram:{};return{appId:t.appId,appEnv:t.envVersion,appVersion:t.version}}return{}}function getAppId(){var e=getAppInfoSync();return e&&e.appId?e.appId:""}function getOpenidNameByAppid(){var e=getAppId(),t="$identity_mp_openid";return e&&(t="$identity_mp_"+e+"_openid"),t}function rot13defs(e){return rot13obfs(e=String(e),113)}function rot13obfs(e,t){t="number"==typeof t?t:13;for(var i=(e=String(e)).split(""),a=0,r=i.length;a<r;a++){i[a].charCodeAt(0)<126&&(i[a]=String.fromCharCode((i[a].charCodeAt(0)+t)%126))}return i.join("")}var hasOwnProperty$1=Object.prototype.hasOwnProperty,store={storageInfo:null,store_queue:[],getUUID:function(){return Date.now()+"-"+Math.floor(1e7*getRandom())+"-"+getRandom().toString(16).replace(".","")+"-"+String(31242*getRandom()).replace(".","").slice(0,8)},getStorage:function(){return this.storageInfo?this.storageInfo:(this.storageInfo=sa._.getStorageSync(saPara.storage_store_key)||"",this.storageInfo)},_state:{},mem:{mdata:[],getLength:function(){return this.mdata.length},add:function(e){this.mdata.push(e)},clear:function(e){this.mdata.splice(0,e)}},toState:function(e){var t=null,i=this;function a(){t.distinct_id?i._state=t:i.set("distinct_id",i.getUUID())}isJSONString(e)?(t=JSON.parse(e),a()):isObject(e)?(t=e,a()):this.set("distinct_id",this.getUUID());var r=this._state._first_id||this._state.first_id,n=this._state._distinct_id||this._state.distinct_id,s=this._state.openid,o=(this._state.history_login_id?this._state.history_login_id:{}).name;if(this._state.identities&&isString(this._state.identities)){var u=JSON.parse(rot13defs(this._state.identities));this._state.identities=u}var c,p,d=getOpenidNameByAppid();if(this._state.identities&&isObject(this._state.identities)&&!isEmptyObject(this._state.identities)){var l=(c=getAppId(),p="$mp_openid",c&&(p="$mp_"+c+"_openid"),p);hasOwnProperty$1.call(this._state.identities,"$mp_id")&&(this._state.identities.$identity_mp_id=this._state.identities.$mp_id,delete this._state.identities.$mp_id),hasOwnProperty$1.call(this._state.identities,"$mp_unionid")&&(this._state.identities.$identity_mp_unionid=this._state.identities.$mp_unionid,delete this._state.identities.$mp_unionid),hasOwnProperty$1.call(this._state.identities,l)&&(this._state.identities[d]=this._state.identities[l],delete this._state.identities[l])}else this._state.identities={},this._state.identities.$identity_mp_id=this.getUUID();function _(e){for(var t in store._state.identities)hasOwnProperty$1.call(store._state.identities,t)&&"$identity_mp_id"!==t&&t!==e&&delete store._state.identities[t]}s&&(this._state.identities[d]=s),r?o&&hasOwnProperty$1.call(this._state.identities,o)?this._state.identities[o]!==n&&(this._state.identities[o]=n,_(o),this._state.history_login_id.value=n):(this._state.identities[IDENTITY_KEY.LOGIN]=n,_(IDENTITY_KEY.LOGIN),this._state.history_login_id={name:IDENTITY_KEY.LOGIN,value:n}):this._state.history_login_id={name:"",value:""},this.save()},getFirstId:function(){return this._state._first_id||this._state.first_id},getDistinctId:function(){var e=this.getLoginDistinctId();return e||(this._state._distinct_id||this._state.distinct_id)},getUnionId:function(){var e={},t=this._state._first_id||this._state.first_id,i=this.getDistinctId();return t&&i?(e.login_id=i,e.anonymous_id=t):e.anonymous_id=i,e},getIdentities:function(){var e=JSON.parse(JSON.stringify(this._state.identities));return e.$identity_anonymous_id=this.getAnonymousId(),e},getAnonymousId:function(){return this.getUnionId().anonymous_id},getHistoryLoginId:function(){return isObject(this._state.history_login_id)?this._state.history_login_id:null},getLoginDistinctId:function(){var e=this.getHistoryLoginId();return isObject(e)&&e.value?e.name!==IDENTITY_KEY.LOGIN?e.name+"+"+e.value:e.value:null},getProps:function(){return this._state.props||{}},setProps:function(e,t){var i=this._state.props||{};t?this.set("props",e):(extend(i,e),this.set("props",i))},set:function(e,t){var i={};for(var a in"string"==typeof e?i[e]=t:"object"==typeof e&&(i=e),this._state=this._state||{},i)this._state[a]=i[a],"first_id"===a?delete this._state._first_id:"distinct_id"===a&&(delete this._state._distinct_id,sa.events.emit("changeDistinctId"));this.save()},identitiesSet:function(e){var t={};switch(e.type){case"login":t.$identity_mp_id=this._state.identities.$identity_mp_id,t[e.id_name]=e.id;break;case"logout":t.$identity_mp_id=this._state.identities.$identity_mp_id}this.set("identities",t)},change:function(e,t){this._state["_"+e]=t},encryptStorage:function(){var e=this.getStorage(),t="data:enc;";isObject(e)?e=t+rot13obfs(JSON.stringify(e)):isString(e)&&-1===e.indexOf(t)&&(e=t+rot13obfs(e)),sa._.setStorageSync(saPara.storage_store_key,e)},save:function(){var e=deepCopy(this._state),t=rot13obfs(JSON.stringify(e.identities));if(e.identities=t,delete e._first_id,delete e._distinct_id,saPara.encrypt_storage){e="data:enc;"+rot13obfs(JSON.stringify(e))}sa._.setStorageSync(saPara.storage_store_key,e)},init:function(){var e=this.getStorage(),t=store.getUUID();if(e)isString(e)&&-1!==e.indexOf("data:enc;")&&(e=e.substring("data:enc;".length),e=JSON.parse(rot13defs(e))),this.toState(e);else{meta.is_first_launch=!0;var i=new Date,a=i.getTime();i.setHours(23),i.setMinutes(59),i.setSeconds(60),this.set({distinct_id:t,first_visit_time:a,first_visit_day_time:i.getTime(),identities:{$identity_mp_id:t},history_login_id:{name:"",value:""}})}this.checkStoreInit()},checkStoreInit:function(){meta.init_status&&(this.store_queue.length>0&&each(this.store_queue,function(e){sa[e.method].apply(sa,slice.call(e.params))}),this.store_queue=[])}};function _decodeURIComponent(e){var t="";try{t=decodeURIComponent(e)}catch(i){t=e}return t}var hasOwnProperty$2=Object.prototype.hasOwnProperty,decodeURIComponent$1=_decodeURIComponent;function initAppGlobalName(){var e=App;App=function(t){t[saPara.name]=sa,e.apply(this,arguments)}}function getPublicPresetProperties(){var e=getRefPage(),t=getCurrentPageInfo(),i={$referrer:e.route,$referrer_title:e.title,$title:t.title,$url:t.url};return!0===saPara.preset_properties.url_path&&(i.$url_path=t.path),i}function encodeDates(e){return each(e,function(t,i){isDate(t)?e[i]=formatDate(t):isObject(t)&&(e[i]=encodeDates(t))}),e}function formatDate(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+t(e.getMilliseconds())}function searchObjDate(e){(isObject(e)||isArray(e))&&each(e,function(t,i){isObject(t)||isArray(t)?searchObjDate(e[i]):isDate(t)&&(e[i]=formatDate(t))})}function formatString(e){return e.length>saPara.max_string_length?(log("\u5b57\u7b26\u4e32\u957f\u5ea6\u8d85\u8fc7\u9650\u5236\uff0c\u5df2\u7ecf\u505a\u622a\u53d6--"+e),e.slice(0,saPara.max_string_length)):e}function searchObjString(e){isObject(e)&&each(e,function(t,i){isObject(t)?searchObjString(e[i]):isString(t)&&(e[i]=formatString(t))})}function parseSuperProperties(e){isObject(e)&&each(e,function(t,i){if(isFunction(t))try{e[i]=t(),isFunction(e[i])&&(log("\u60a8\u7684\u5c5e\u6027- "+i+" \u683c\u5f0f\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u6211\u4eec\u5df2\u7ecf\u5c06\u5176\u5220\u9664"),delete e[i])}catch(t){delete e[i],log("\u60a8\u7684\u5c5e\u6027- "+i+" \u629b\u51fa\u4e86\u5f02\u5e38\uff0c\u6211\u4eec\u5df2\u7ecf\u5c06\u5176\u5220\u9664")}})}function unique(e){for(var t,i=[],a={},r=0;r<e.length;r++)(t=e[r])in a||(a[t]=!0,i.push(t));return i}var check={checkKeyword:function(e){return/^((?!^distinct_id$|^original_id$|^device_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$|^user_group|^user_tag)[a-zA-Z_$][a-zA-Z\d_$]{0,99})$/i.test(e)},checkIdLength:function(e){return!(String(e).length>255)||(log("id \u957f\u5ea6\u8d85\u8fc7 255 \u4e2a\u5b57\u7b26\uff01"),!1)}};function strip_sa_properties(e){return isObject(e)?(each(e,function(t,i){if(isArray(t)){var a=[];each(t,function(e){if(isString(e))a.push(e);else if(isUndefined(e))a.push("null");else try{a.push(JSON.stringify(e))}catch(e){log("\u60a8\u7684\u6570\u636e - "+i+":"+t+" - \u7684\u6570\u7ec4\u91cc\u7684\u503c\u6709\u9519\u8bef,\u5df2\u7ecf\u5c06\u5176\u5220\u9664")}}),e[i]=a}if(isObject(t))try{e[i]=JSON.stringify(t)}catch(a){delete e[i],log("\u60a8\u7684\u6570\u636e - "+i+":"+t+" - \u7684\u6570\u636e\u503c\u6709\u9519\u8bef,\u5df2\u7ecf\u5c06\u5176\u5220\u9664")}else isString(t)||isNumber(t)||isDate(t)||isBoolean(t)||isArray(t)||(log("\u60a8\u7684\u6570\u636e - "+i+":"+t+" - \u683c\u5f0f\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u5df2\u7ecf\u5c06\u5176\u5220\u9664"),delete e[i])}),e):e}function strip_empty_properties(e){var t={};return each(e,function(e,i){null==e&&void 0===e||(t[i]=e)}),t}function utf8Encode(e){var t,i,a,r,n="";for(t=i=0,a=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,r=0;r<a;r++){var s=e.charCodeAt(r),o=null;s<128?i++:o=s>127&&s<2048?String.fromCharCode(s>>6|192,63&s|128):String.fromCharCode(s>>12|224,s>>6&63|128,63&s|128),null!==o&&(i>t&&(n+=e.substring(t,i)),n+=o,t=i=r+1)}return i>t&&(n+=e.substring(t,e.length)),n}function base64Encode(e){var t,i,a,r,n,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=0,u=0,c="",p=[];if(!e)return e;e=utf8Encode(e);do{t=(n=e.charCodeAt(o++)<<16|e.charCodeAt(o++)<<8|e.charCodeAt(o++))>>18&63,i=n>>12&63,a=n>>6&63,r=63&n,p[u++]=s.charAt(t)+s.charAt(i)+s.charAt(a)+s.charAt(r)}while(o<e.length);switch(c=p.join(""),e.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c}function btoa(e){for(var t,i,a,r,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="",o=0,u=(e=String(e)).length%3;o<e.length;)((i=e.charCodeAt(o++))>255||(a=e.charCodeAt(o++))>255||(r=e.charCodeAt(o++))>255)&&log("Failed to execute 'btoa' : The string to be encoded contains characters outside of the Latin1 range."),s+=n.charAt((t=i<<16|a<<8|r)>>18&63)+n.charAt(t>>12&63)+n.charAt(t>>6&63)+n.charAt(63&t);return u?s.slice(0,u-3)+"===".substring(u):s}function urlBase64Encode(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))}function getCurrentPage(){var e={};try{var t=getCurrentPages();e=t[t.length-1]}catch(e){log(e)}return e}function getCurrentPath(){var e="\u672a\u53d6\u5230";try{var t=getCurrentPage();e=t?t.route:e}catch(e){log(e)}return e}function getIsFirstDay(){return!!("object"==typeof store._state&&isNumber(store._state.first_visit_day_time)&&store._state.first_visit_day_time>(new Date).getTime())}function getCurrentUrl(e){var t=getCurrentPath(),i="";return isObject(e)&&e.sensors_mp_encode_url_query&&(i=e.sensors_mp_encode_url_query),t?i?t+"?"+i:t:"\u672a\u53d6\u5230"}function getPath(e){return e=isString(e)?e.replace(/^\//,""):"\u53d6\u503c\u5f02\u5e38"}function getCustomUtmFromQuery(e,t,i,a){if(!isObject(e))return{};var r={};if(e.sa_utm)for(var n in e)"sa_utm"!==n?include(saPara.source_channel,n)&&(r[i+n]=e[n]):r[a+n]=e[n];else for(var s in e)-1===(" "+SOURCE_CHANNEL_STANDARD+" ").indexOf(" "+s+" ")?include(saPara.source_channel,s)&&(r[i+s]=e[s]):r[t+s]=e[s];return r}function getObjFromQuery(e){var t=e.split("?"),i=[],a={};return t&&t[1]?(each(t[1].split("&"),function(e){(i=e.split("="))[0]&&i[1]&&(a[i[0]]=i[1])}),a):{}}function setStorageSync(e,t){var i=function(){wx.setStorageSync(e,t)};try{i()}catch(e){log("set Storage fail --",e);try{i()}catch(e){log("set Storage fail again --",e)}}}function getStorageSync(e){var t="";try{t=wx.getStorageSync(e)}catch(e){log("getStorage fail")}return t}function getMPScene(e){return isNumber(e)||isString(e)&&""!==e?e="wx-"+String(e):"\u672a\u53d6\u5230\u503c"}function objToParam(e,t){if(!isObject(e))return log("\u8bf7\u4f20\u5165\u6709\u6548\u5bf9\u8c61"),"";var i=[];for(var a in e)if(hasOwnProperty$2.call(e,a)){var r=e[a];void 0===r?i.push(a+"="):(r=t?encodeURIComponent(r):r,i.push(a+"="+r))}return i.join("&")}function delObjectKey(e){if(isObject(e))for(var t=0;t<SHARE_INFO_KEY.length;t++)delete e[SHARE_INFO_KEY[t]];else log("\u8bf7\u4f20\u5165\u6709\u6548\u5bf9\u8c61")}function shareInfoData(e){var t={},i={};if(saPara.preset_events.share_info_use_string){i=e.query;for(var a=0;a<SHARE_INFO_KEY.length;a++){if(!hasOwnProperty$2.call(i,SHARE_INFO_KEY[a]))return{};i[SHARE_INFO_KEY[a]]=_decodeURIComponent(i[SHARE_INFO_KEY[a]])}t={depth:Number(i.sensors_share_d),path:i.sensors_share_p||"",id:i.sensors_share_i||"",method:i.sensors_share_m||""}}else{if(!e.query.sampshare)return{};if(!isJSONString(i=_decodeURIComponent(e.query.sampshare)))return{};t={depth:(i=JSON.parse(i)).d,path:i.p,id:i.i,method:i.m}}return t}function setShareInfo(e,t){var i={},a={},r=store.getDistinctId(),n=store.getFirstId();if(e&&isObject(e.query)){if(isEmptyObject(i=shareInfoData(e)))return{};var s=i.depth,o=i.path,u=i.id,c=i.method}"string"==typeof u?(t.$share_distinct_id=u,meta.share_distinct_id=u,a.$latest_share_distinct_id=u):t.$share_distinct_id="\u53d6\u503c\u5f02\u5e38","number"==typeof s?!meta.share_distinct_id||meta.share_distinct_id!==r&&meta.share_distinct_id!==n?!meta.share_distinct_id||meta.share_distinct_id===r&&meta.share_distinct_id===n?t.$share_depth="-1":(t.$share_depth=s+1,meta.query_share_depth=s+1,a.$latest_share_depth=s+1):(t.$share_depth=s,meta.query_share_depth=s,a.$latest_share_depth=s):t.$share_depth="-1","string"==typeof o?(t.$share_url_path=o,a.$latest_share_url_path=o):t.$share_url_path="\u53d6\u503c\u5f02\u5e38","string"==typeof c?(t.$share_method=c,a.$latest_share_method=c):t.$share_method="\u53d6\u503c\u5f02\u5e38",setLatestShare(a)}function getShareInfo(){if(saPara.preset_events.share_info_use_string)return objToParam({sensors_share_i:store.getDistinctId()||"\u53d6\u503c\u5f02\u5e38",sensors_share_p:getCurrentPath(),sensors_share_d:meta.query_share_depth,sensors_share_m:meta.share_method},!0);var e=JSON.stringify({i:store.getDistinctId()||"\u53d6\u503c\u5f02\u5e38",p:getCurrentPath(),d:meta.query_share_depth,m:meta.share_method});return"sampshare="+encodeURIComponent(e)}function detectOptionQuery(e){if(!e||!isObject(e.query))return{};var t,i,a,r,n={};return n.query=extend({},e.query),"string"==typeof n.query.scene&&(t=n.query,i=["utm_source","utm_content","utm_medium","utm_campaign","utm_term","sa_utm"].concat(saPara.source_channel),a=new RegExp("("+i.join("|")+")%3D","i"),1===(r=Object.keys(t)).length&&"scene"===r[0]&&a.test(t.scene))&&(n.scene=n.query.scene,delete n.query.scene),e.query.q&&e.query.scancode_time&&"101"===String(e.scene).slice(0,3)&&(n.q=String(n.query.q),delete n.query.q,delete n.query.scancode_time),n}function getMixedQuery(e){var t=detectOptionQuery(e),i=t.scene,a=t.q,r=t.query;for(var n in r)r[n]=_decodeURIComponent(r[n]);return i&&extend(r,getObjFromQuery(i=-1!==(i=_decodeURIComponent(i)).indexOf("?")?"?"+i.replace(/\?/g,""):"?"+i)),a&&extend(r,getObjFromQuery(_decodeURIComponent(a))),r}function setUtm(e,t){var i={},a=getMixedQuery(e),r=getCustomUtmFromQuery(a,"$","_","$"),n=getCustomUtmFromQuery(a,"$latest_","_latest_","$latest_");return i.pre1=r,i.pre2=n,extend(t,r),i}function setSfSource(e,t){isEmptyObject(e.query)||e.query&&e.query._sfs&&(t.$sf_source=e.query._sfs,sa.registerApp({$latest_sf_source:t.$sf_source}))}function setPageSfSource(e){try{var t=getCurrentPage(),i=deepCopy(t?t.options:"");for(var a in i)i[a]=_decodeURIComponent(i[a]);!isEmptyObject(i)&&i._sfs&&(e.$sf_source=i._sfs)}catch(e){log(e)}}function setRefPage(){var e={route:"\u76f4\u63a5\u6253\u5f00",path:"\u76f4\u63a5\u6253\u5f00",title:""};try{var t=getCurrentPage();if(t&&t.route){var i=t.sensors_mp_url_query?"?"+t.sensors_mp_url_query:"",a=t.route,r=getPageTitle(a);e.route=a+i,e.path=a,e.title=r,meta.page_route_map.length>=2?(meta.page_route_map.shift(),meta.page_route_map.push(e)):meta.page_route_map.push(e)}}catch(e){log(e)}}function getRefPage(){var e={route:"\u76f4\u63a5\u6253\u5f00",path:"\u76f4\u63a5\u6253\u5f00",title:""};return meta.page_route_map.length>1&&(e.title=meta.page_route_map[0].title,e.route=meta.page_route_map[0].route,e.path=meta.page_route_map[0].path),e}function getCurrentPageInfo(){var e=getCurrentPage(),t={title:"",url:"",path:"\u672a\u53d6\u5230"};if(e&&e.route){var i=e.sensors_mp_url_query?"?"+e.sensors_mp_url_query:"";t.title=getPageTitle(e.route),t.url=e.route+i,t.path=e.route}return t}function setPageRefData(e,t,i){var a=getRefPage();isObject(e)&&(t?meta.page_route_map.length>0&&t?(i=i?"?"+i:"",e.$referrer=getPath(t)+i,e.$referrer_title=getPageTitle(t)):(e.$referrer="\u76f4\u63a5\u6253\u5f00",e.$referrer_title=""):(e.$referrer=a.route,e.$referrer_title=a.title))}function getPageTitle(e){if("\u672a\u53d6\u5230"===e||!e)return"";var t="";try{if(__wxConfig){var i=__wxConfig,a=__wxConfig.page||{},r=a[e]||a[e+".html"],n={},s={};if(i.global&&i.global.window&&i.global.window.navigationBarTitleText&&(n.titleVal=i.global.window.navigationBarTitleText),r&&r.window&&r.window.navigationBarTitleText&&(s.titleVal=r.window.navigationBarTitleText),!s.titleVal&&__wxAppCode__){var o=__wxAppCode__[e+".json"];o&&o.navigationBarTitleText&&(s.titleVal=o.navigationBarTitleText)}if(each(meta.global_title,function(i,a){if(a===e)return t=i}),0===t.length){var u=extend(n,s);t=u.titleVal||""}}}catch(e){log(e)}return t}function wxrequest(e){if(compareSDKVersion(meta.wx_sdk_version,"2.10.0")>=0)e.timeout=saPara.datasend_timeout,wx.request(e);else{var t=wx.request(e);setTimeout(function(){isObject(t)&&isFunction(t.abort)&&t.abort()},saPara.datasend_timeout)}}function validId(e){return"string"!=typeof e&&"number"!=typeof e||""===e?(log("\u8f93\u5165 ID \u7c7b\u578b\u9519\u8bef"),!1):"number"!=typeof e||(e=String(e),/^\d+$/.test(e))?!!check.checkIdLength(e)&&e:(log("\u8f93\u5165 ID \u7c7b\u578b\u9519\u8bef"),!1)}function compareSDKVersion(e,t){e=e.split("."),t=t.split(".");for(var i=Math.max(e.length,t.length);e.length<i;)e.push("0");for(;t.length<i;)t.push("0");for(var a=0;a<i;a++){var r=parseInt(e[a]),n=parseInt(t[a]);if(r>n)return 1;if(r<n)return-1}return 0}function setUpperCase(e){return isString(e)?e.toLocaleUpperCase():e}function setLatestChannel(e){isEmptyObject(e)||(function(e,t){var i=!1;for(var a in t)e[t[a]]&&(i=!0);return i}(e,LATEST_SOURCE_CHANNEL)&&(sa.clearAppRegister(LATEST_SOURCE_CHANNEL),sa.clearAllProps(LATEST_SOURCE_CHANNEL)),saPara.is_persistent_save.utm?sa.register(e):sa.registerApp(e))}function setLatestShare(e){(e.$latest_share_depth||e.$latest_share_distinct_id||e.$latest_share_url_path||e.$latest_share_method)&&(sa.clearAppRegister(LATEST_SHARE_INFO),sa.clearAllProps(LATEST_SHARE_INFO),saPara.is_persistent_save.share?sa.register(e):sa.registerApp(e))}function setQuery(e,t){if(e&&isObject(e)&&!isEmptyObject(e)){var i=[];return each(e,function(e,a){"q"===a&&isString(e)&&0===e.indexOf("http")||(t?i.push(a+"="+e):i.push(a+"="+_decodeURIComponent(e)))}),i.join("&")}return""}function setNavigationBarTitle(){try{var e=wx.setNavigationBarTitle;Object.defineProperty(wx,"setNavigationBarTitle",{get:function(){return function(t){var i=getCurrentPath();t=isObject(t)?t:{},meta.global_title[i]=t.title,e.call(this,t)}}})}catch(e){log(e)}}function getUtmFromPage(){var e={};try{var t=deepCopy(getCurrentPage().options);for(var i in t)t[i]=_decodeURIComponent(t[i]);e=getCustomUtmFromQuery(t,"$","_","$")}catch(e){log(e)}return e}function isNewLoginId(e,t){return e!==store._state.history_login_id.name||store._state.history_login_id.value!==t}function isSameAndAnonymousID(e){var t=store.getFirstId(),i=store.getDistinctId();return t?e===t:e===i}function isPresetIdKeys(e,t){var i=["$identity_anonymous_id"];for(var a of(isArray(t)&&(i=i.concat(t)),i))if(a===e)return!0;return!1}function encodeTrackData(e){var t=base64Encode(e=JSON.stringify(e));return encodeURIComponent(t)}function setPublicProperties(e){if(e&&e.properties){var t=getRefPage(),i=getCurrentPageInfo(),a={$referrer:t.route,$referrer_title:t.title,$title:i.title,$url:i.url};for(var r in!0===saPara.preset_properties.url_path&&(a.$url_path=i.path),a)hasOwnProperty$2.call(e.properties,r)||(e.properties[r]=a[r])}}function networkStatusChange(){wx.onNetworkStatusChange(function(e){sa.registerApp({$network_type:e.networkType||""})})}function getNetworkType(){return new Promise((e,t)=>{wx.getNetworkType({success:function(t){meta.preset_properties.$network_type=setUpperCase(t.networkType),e()},fail:function(e){log("\u83b7\u53d6\u7f51\u7edc\u4fe1\u606f\u5931\u8d25",e),t()}})})}function getSystemInfo(){var e=meta.preset_properties;return new Promise(t=>{wx.getSystemInfo({success:function(i){var a,r;e.$brand=setUpperCase(i.brand),e.$manufacturer=i.brand,e.$model=i.model,e.$screen_width=Number(i.screenWidth),e.$screen_height=Number(i.screenHeight),e.$os=(a=i.platform,"ios"===(r=a.toLowerCase())?"iOS":"android"===r?"Android":a),e.$os_version=i.system.indexOf(" ")>-1?i.system.split(" ")[1]:i.system,meta.wx_sdk_version=i.SDKVersion,e.$mp_client_app_version=i.version,e.$mp_client_basic_library_version=meta.wx_sdk_version;var n=(new Date).getTimezoneOffset(),s=getAppInfoSync();isNumber(n)&&(e.$timezone_offset=n),s.appId&&(e.$app_id=s.appId),s.appVersion&&(e.$app_version=s.appVersion),t()}})})}var info={currentProps:meta.preset_properties},logger={info:function(){if(saPara.show_log&&"object"==typeof console&&console.log)try{if(3===arguments.length)return console.log(arguments[0],arguments[1],arguments[2]);if(2===arguments.length)return console.log(arguments[0],arguments[1]);if(1===arguments.length)return console.log(arguments[0])}catch(e){console.log(arguments[0])}}};function isValidListener(e){return"function"==typeof e||!(!e||"object"!=typeof e)&&isValidListener(e.listener)}class EventEmitterBase{constructor(){this._events={}}on(e,t){if(!e||!t)return!1;if(!isValidListener(t))throw new Error("listener must be a function");this._events[e]=this._events[e]||[];var i="object"==typeof t;return this._events[e].push(i?t:{listener:t,once:!1}),this}prepend(e,t){if(!e||!t)return!1;if(!isValidListener(t))throw new Error("listener must be a function");this._events[e]=this._events[e]||[];var i="object"==typeof t;return this._events[e].unshift(i?t:{listener:t,once:!1}),this}prependOnce(e,t){return this.prepend(e,{listener:t,once:!0})}once(e,t){return this.on(e,{listener:t,once:!0})}off(e,t){var i=this._events[e];if(!i)return!1;if("number"==typeof t)i.splice(t,1);else if("function"==typeof t)for(var a=0,r=i.length;a<r;a++)i[a]&&i[a].listener===t&&i.splice(a,1);return this}emit(e,t){var i=this._events[e];if(!i)return!1;for(var a=0;a<i.length;a++){var r=i[a];r&&(r.listener.call(this,t||{}),r.once&&this.off(e,a))}return this}removeAllListeners(e){e&&this._events[e]?this._events[e]=[]:this._events={}}listeners(e){return e&&"string"==typeof e?this._events[e]:this._events}}class EventEmitterEx extends EventEmitterBase{constructor(){super(),this.cacheEvents=[],this.maxLen=20}replay(e,t){this.on(e,t),this.cacheEvents.length>0&&this.cacheEvents.forEach(function(i){i.type===e&&t.call(null,i.data)})}emit(e,t){super.emit.apply(this,arguments),this.cacheEvents.push({type:e,data:t}),this.cacheEvents.length>this.maxLen&&this.cacheEvents.shift()}}var _=Object.freeze({__proto__:null,decodeURIComponent:decodeURIComponent$1,encodeDates:encodeDates,formatDate:formatDate,searchObjDate:searchObjDate,formatString:formatString,searchObjString:searchObjString,parseSuperProperties:parseSuperProperties,unique:unique,check:check,getUtmFromPage:getUtmFromPage,setQuery:setQuery,setLatestShare:setLatestShare,setLatestChannel:setLatestChannel,setUpperCase:setUpperCase,compareSDKVersion:compareSDKVersion,validId:validId,wxrequest:wxrequest,getPageTitle:getPageTitle,setPageRefData:setPageRefData,getCurrentPageInfo:getCurrentPageInfo,getRefPage:getRefPage,setRefPage:setRefPage,setPageSfSource:setPageSfSource,setSfSource:setSfSource,setUtm:setUtm,getMixedQuery:getMixedQuery,detectOptionQuery:detectOptionQuery,getShareInfo:getShareInfo,setShareInfo:setShareInfo,shareInfoData:shareInfoData,delObjectKey:delObjectKey,objToParam:objToParam,getMPScene:getMPScene,getStorageSync:getStorageSync,setStorageSync:setStorageSync,getObjFromQuery:getObjFromQuery,getCustomUtmFromQuery:getCustomUtmFromQuery,getPath:getPath,getCurrentUrl:getCurrentUrl,getIsFirstDay:getIsFirstDay,getCurrentPath:getCurrentPath,getCurrentPage:getCurrentPage,urlBase64Encode:urlBase64Encode,btoa:btoa,base64Encode:base64Encode,strip_empty_properties:strip_empty_properties,strip_sa_properties:strip_sa_properties,setNavigationBarTitle:setNavigationBarTitle,networkStatusChange:networkStatusChange,getNetworkType:getNetworkType,getSystemInfo:getSystemInfo,encodeTrackData:encodeTrackData,initAppGlobalName:initAppGlobalName,getPublicPresetProperties:getPublicPresetProperties,setPublicProperties:setPublicProperties,isPresetIdKeys:isPresetIdKeys,isNewLoginId:isNewLoginId,isSameAndAnonymousID:isSameAndAnonymousID,info:info,logger:logger,getAppId:getAppId,getAppInfoSync:getAppInfoSync,getOpenidNameByAppid:getOpenidNameByAppid,rot13defs:rot13defs,rot13obfs:rot13obfs,each:each,isObject:isObject,getRandom:getRandom,extend:extend,extend2Lev:extend2Lev,coverExtend:coverExtend,isArray:isArray,isFunction:isFunction,isArguments:isArguments,toArray:toArray,values:values,include:include,trim:trim,isEmptyObject:isEmptyObject,deepCopy:deepCopy,isUndefined:isUndefined,isString:isString,isDate:isDate,isBoolean:isBoolean,isNumber:isNumber,isJSONString:isJSONString,isInteger:isInteger,isSafeInteger:isSafeInteger,slice:slice,urlSafeBase64:urlSafeBase64,EventEmitterBase:EventEmitterBase,EventEmitterEx:EventEmitterEx,log:log});function onEventSend(){return{}}function processData(e){return e}function batchTrackData(e){var t=Date.now();return e.forEach(function(e){e._flush_time=t}),"data_list="+encodeTrackData(e)}var mergeStorageData={getData:function(e){wx.getStorage({key:saPara.storage_prepare_data_key,complete:function(t){var i=t.data&&isArray(t.data)?t.data:[];mergeStorageData.deleteAesData(i),e&&e()}})},deleteAesData:function(e){var t=[],i=e.length;if(i>0){for(var a=0;a<i;a++)isObject(e[a])&&t.push(e[a]);store.mem.mdata=t.concat(store.mem.mdata)}}};function onceTrackData(e){return"data="+encodeTrackData(e)}var kit={};function setKitTitle(e){if(!isString(e))return!1;var t=meta.page_route_map.length-1;t>=0&&(meta.page_route_map[t].title=e)}kit.setData=function(e){if(!isObject(e))return!1;e.current_title&&setKitTitle(e.current_title)},kit.processData=processData,kit.onceTrackData=onceTrackData,kit.batchTrackData=batchTrackData,kit.onEventSend=onEventSend,kit.onceSend=function(){};var sendStrategy={dataHasSend:!0,dataHasChange:!1,syncStorage:!1,failTime:0,init:function(){this.sendHasInit=!0,mergeStorageData.getData(sendStrategy.syncStorageState.bind(sendStrategy)),this.batchInterval(),this.onAppHide()},syncStorageState:function(){this.syncStorage=!0},onAppHide:function(){var e=this;wx.onAppHide(function(){saPara.batch_send&&e.batchSend()})},send:function(e){this.dataHasChange=!0,store.mem.getLength()>=500&&(log("storage data is too large"),store.mem.mdata.shift()),(e=kit.processData(e))&&store.mem.add(e),this.sendAsOver()},sendAsOver:function(){this.sendHasInit&&store.mem.getLength()>=saPara.batch_send.max_length&&this.batchSend()},wxrequest:function(e){if(isArray(e.data)&&e.data.length>0){var t=kit.batchTrackData(e.data);sa._.wxrequest({url:saPara.server_url,method:"POST",dataType:"text",data:t,header:{"content-type":"text/plain"},success:function(){e.success(e.len)},fail:function(){e.fail()}})}else e.success(e.len)},batchSend:function(){if(this.dataHasSend){var e,t,i=store.mem.mdata;(t=(e=i.length>=100?i.slice(0,100):i).length)>0&&(this.dataHasSend=!1,this.wxrequest({data:e,len:t,success:this.batchRemove.bind(this),fail:this.sendFail.bind(this)}))}},sendFail:function(){this.dataHasSend=!0,this.failTime++},batchRemove:function(e){store.mem.clear(e),this.dataHasSend=!0,this.dataHasChange=!0,this.batchWrite(),this.failTime=0},is_first_batch_write:!0,batchWrite:function(){this.dataHasChange&&(this.dataHasChange=!1,this.syncStorage&&sa._.setStorageSync(saPara.storage_prepare_data_key,store.mem.mdata))},batchInterval:function(){var e=this;!function t(){setTimeout(function(){e.batchWrite(),t()},500)}(),function t(){setTimeout(function(){e.batchSend(),t()},saPara.batch_send.send_timeout*Math.pow(2,e.failTime))}()}};function buildData(e,t){var i={distinct_id:sa.store.getDistinctId(),identities:extend({},sa.store.getIdentities()),lib:{$lib:LIB_NAME,$lib_method:"code",$lib_version:LIB_VERSION},properties:{}};return isObject(t)||(t={}),"track_id_unbind"===e.type&&"$UnbindID"===e.event&&(i.identities=deepCopy(e.unbind_value),delete e.unbind_value),extend(i,sa.store.getUnionId(),e),isObject(e.properties)&&!isEmptyObject(e.properties)&&extend(i.properties,e.properties),"track_id_unbind"===e.type&&"$UnbindID"===e.event&&(i.login_id&&delete i.login_id,i.anonymous_id&&delete i.anonymous_id),e.type&&"profile"===e.type.slice(0,7)||(i._track_id=Number(String(getRandom()).slice(2,5)+String(getRandom()).slice(2,4)+String(Date.now()).slice(-4)),i.properties=extend({},getPublicPresetProperties(),meta.preset_properties,sa.store.getProps(),t,i.properties),"track"===e.type&&(i.properties.$is_first_day=getIsFirstDay())),i.properties.$time&&isDate(i.properties.$time)?(i.time=1*i.properties.$time,delete i.properties.$time):i.time=1*new Date,sa.ee.sdk.emit("createData",i),sa.ee.sdk.emit("beforeBuildCheck",i),sa.ee.data.emit("beforeBuildCheck",i),parseSuperProperties(i.properties),searchObjDate(i),strip_sa_properties(i.properties),searchObjString(i),sa.ee.data.emit("finalAdjustData",i),i}function dataStage(e){if(!saPara.server_url)return!1;if(meta.current_scene&&1154===meta.current_scene&&!sa.para.preset_events.moments_page)return!1;var t=sa._.deepCopy(e),i=buildData(e,kit.onEventSend(t));i?(log(i),sa.events.emit("send",i),sa.para.batch_send?sendStrategy.send(i):sa.kit.onceSend(i)):log("error: \u6570\u636e\u5f02\u5e38 "+i)}sa.popupEmitter={attached:function(){return!1}};var usePlugin=function(e,t){if(!isObject(e)&&!isFunction(e))return log("plugin must be an object",e),!1;if(isFunction(e.init)||log("plugin maybe missing init method",e.plugin_name||e),isString(e.plugin_name)&&e.plugin_name?sa.modules[e.plugin_name]?e=sa.modules[e.plugin_name]:sa.modules[e.plugin_name]=e:log("plugin_name is not defined - ",e.plugin_name||e),isObject(e)&&!0===e.plugin_is_init)return e;if(isObject(e)&&e.plugin_name&&(isString(e.plugin_version)&&e.plugin_version===LIB_VERSION||log("warning!"+e.plugin_name+" plugin version do not match SDK version \uff01\uff01\uff01")),meta.init_status)"function"==typeof e.init&&(e.init(sa,t),e.plugin_is_init=!0,log(e.plugin_name+" plugin is initialized"));else{var i={target:e,para:t};meta.plugin.uninitialized_list.push(i)}return e},use=function(e,t){return isObject(e)||isFunction(e)?(isFunction(e.init)||log("plugin maybe missing init method",e.plugin_name||e),isString(e.plugin_name)&&e.plugin_name?sa.modules[e.plugin_name]?e=sa.modules[e.plugin_name]:sa.modules[e.plugin_name]=e:log("plugin_name is not defined - ",e.plugin_name||e),isObject(e)&&!0===e.plugin_is_init?e:(isObject(e)&&e.plugin_name&&(isString(e.plugin_version)&&e.plugin_version===LIB_VERSION||log("warning!"+e.plugin_name+" plugin version do not match SDK version \uff01\uff01\uff01")),"function"==typeof e.init&&(e.init(sa,t),e.plugin_is_init=!0,log(e.plugin_name+" plugin is initialized")),e)):(log("plugin must be an object",e),!1)},checkPluginInitStatus=function(){if(meta.plugin.uninitialized_list.length>0){for(var e in meta.plugin.uninitialized_list){var t=meta.plugin.uninitialized_list[e];t&&t.target&&"function"==typeof t.target.init&&!t.target.plugin_is_init&&(t.target.init(sa,t.para),isObject(t.target)&&(t.target.plugin_is_init=!0,isString(t.target.plugin_name)&&t.target.plugin_name&&log(t.target.plugin_name+" plugin is initialized")))}meta.plugin.uninitialized_list=[]}};function initAppShowHide(){wx.onAppShow(function(e){if(!meta.life_state.app_launched){var t=wx.getLaunchOptionsSync()||{};sa.autoTrackCustom.appLaunch(t)}sa.autoTrackCustom.appShow(e)}),wx.onAppHide(function(){sa.autoTrackCustom.appHide()})}function checkAppLaunch(){if(!meta.life_state.app_launched){var e=wx.getLaunchOptionsSync()||{};sa.autoTrackCustom.appLaunch(e)}}function mpProxy(e,t,i){var a=sa.autoTrackCustom[i];if(e[t]){var r=e[t];e[t]=function(){!sa.para.autoTrackIsFirst||isObject(sa.para.autoTrackIsFirst)&&!sa.para.autoTrackIsFirst[i]?(r.apply(this,arguments),a.apply(this,arguments)):(!0===sa.para.autoTrackIsFirst||isObject(sa.para.autoTrackIsFirst)&&sa.para.autoTrackIsFirst[i])&&(a.apply(this,arguments),r.apply(this,arguments)),sa.ee.page.emit(i)}}else e[t]=function(){a.apply(this,arguments),sa.ee.page.emit(i)}}function clickTrack(e){var t,i={},a={},r=e.currentTarget||{},n=e.target||{};if(isObject(sa.para.framework)&&isObject(sa.para.framework.taro)&&!sa.para.framework.taro.createApp&&n.id&&r.id&&n.id!==r.id)return!1;var s=r.dataset||{};if(t=e.type,i.$element_id=r.id,i.$element_type=s.type,i.$element_content=s.content,i.$element_name=s.name,isObject(e.event_prop)&&(a=e.event_prop),t&&isClick(t)){if(sa.para.preset_events&&sa.para.preset_events.collect_element&&!1===sa.para.preset_events.collect_element(arguments[0]))return!1;i.$url_path=sa._.getCurrentPath(),sa._.setPageRefData(i),i=sa._.extend(i,a),sa.track("$MPClick",i)}}function clickProxy(e,t){var i=e[t];e[t]=function(){var e=i.apply(this,arguments),t=arguments[0];return isObject(t)&&(sa.para.preset_events.defer_track?setTimeout(function(){clickTrack(t)},0):clickTrack(t)),e}}function isClick(e){return!!{tap:1,longpress:1,longtap:1}[e]}function tabProxy(e){var t=e.onTabItemTap;e.onTabItemTap=function(e){t&&t.apply(this,arguments);var i={};e&&(i.$element_content=e.text),i.$element_type="tabBar",i.$url_path=sa._.getCurrentPath(),sa._.setPageRefData(i),sa.track("$MPClick",i)}}function getMethods(e){var t=MP_FILTER_HOOK,i=[];for(var a in e)"function"!=typeof e[a]||t[a]||i.push(a);return i}function initPageProxy(){var e=Page;Page=function(t){try{t||(t={}),monitorClick(t),monitorHooks(t),e.apply(this,arguments)}catch(t){e.apply(this,arguments)}};var t=Component;Component=function(e){try{e||(e={}),e.methods||(e.methods={}),monitorClick(e.methods),monitorHooks(e.methods),t.apply(this,arguments)}catch(e){t.apply(this,arguments)}}}function monitorClick(e){var t=[];if(sa.para.autoTrack&&sa.para.autoTrack.mpClick){t=getMethods(e),tabProxy(e);for(var i=t.length,a=0;a<i;a++)clickProxy(e,t[a])}}function monitorHooks(e){mpProxy(e,"onLoad","pageLoad"),mpProxy(e,"onShow","pageShow"),mpProxy(e,"onHide","pageHide"),mpProxy(e,"onUnload","pageHide"),mpProxy(e,"onAddToFavorites","pageAddFavorites"),"function"==typeof e.onShareAppMessage&&sa.autoTrackCustom.pageShare(e),"function"==typeof e.onShareTimeline&&sa.autoTrackCustom.pageShareTimeline(e)}var eventEmitter=function(){this.sub=[]};eventEmitter.prototype={add:function(e){this.sub.push(e)},emit:function(e,t){this.sub.forEach(function(i){i.on(e,t)})}};var eventSub=function(e){sa.events.add(this),this._events=[],this.handle=e,this.ready=!1};eventSub.prototype={on:function(e,t){if(this.ready){if(isFunction(this.handle))try{this.handle(e,t)}catch(e){log(e)}}else this._events.push({event:e,data:t})},isReady:function(){var e=this;e.ready=!0,e._events.forEach(function(t){if(isFunction(e.handle))try{e.handle(t.event,t.data)}catch(e){log(e)}})}};var ee={};function checkPrivacyStatus(){var e;return global&&global.sensors_data_pre_config&&(e=!!global.sensors_data_pre_config.is_compliance_enabled&&global.sensors_data_pre_config.is_compliance_enabled),!e||(!!meta.init_status||!!meta.privacy.enable_data_collect)}function enableDataCollect(){meta.privacy.enable_data_collect=!0}function apiStaging(){each(["resetAnonymousIdentity","setProfile","setOnceProfile","track","quick","incrementProfile","appendProfile","login","logout","registerApp","register","clearAllRegister","clearAllProps","clearAppRegister","bind","unbind","bindOpenid","unbindOpenid","bindUnionid","unbindUnionid"],function(e){var t=sa[e];sa[e]=function(){return!!checkPrivacyStatus()&&((!isFunction(sa.getDisabled)||!sa.getDisabled())&&void(meta.initialState.isComplete?t.apply(sa,arguments):meta.initialState.queue.push([e,arguments])))}})}function registerApp(e){isObject(e)&&!isEmptyObject(e)&&(meta.preset_properties=extend(meta.preset_properties,e))}function register(e){isObject(e)&&!isEmptyObject(e)&&store.setProps(e)}function clearAllRegister(){store.setProps({},!0)}function clearAppRegister(e){isArray(e)&&each(meta.preset_properties,function(t,i){include(e,i)&&delete meta.preset_properties[i]})}function clearAllProps(e){var t=store.getProps(),i={};isArray(e)&&(each(t,function(t,a){include(e,a)||(i[a]=t)}),store.setProps(i,!0))}ee.sdk=new EventEmitterEx,ee.data=new EventEmitterEx,ee.page=new EventEmitterEx;var hasOwnProperty$3=Object.prototype.hasOwnProperty;function setProfile(e,t){dataStage({type:"profile_set",properties:e})}function setOnceProfile(e,t){dataStage({type:"profile_set_once",properties:e})}function appendProfile(e,t){if(!isObject(e))return!1;each(e,function(t,i){isString(t)?e[i]=[t]:isArray(t)?e[i]=t:(delete e[i],log("appendProfile\u5c5e\u6027\u7684\u503c\u5fc5\u987b\u662f\u5b57\u7b26\u4e32\u6216\u8005\u6570\u7ec4"))}),dataStage({type:"profile_append",properties:e})}function incrementProfile(e,t){if(!isObject(e))return!1;var i=e;isString(e)&&((e={})[i]=1),dataStage({type:"profile_increment",properties:e})}function track(e,t,i){dataStage({type:"track",event:e,properties:t})}function identify(e){if(!checkPrivacyStatus())return!1;if(!meta.init_status)return store.store_queue.push({method:"identify",params:arguments}),!1;(e=validId(e))&&(store.getFirstId()?store.set("first_id",e):store.set("distinct_id",e))}function resetAnonymousIdentity(e){if(store.getFirstId())return log("resetAnonymousIdentity must be used in a logout state \uff01"),!1;if("number"==typeof e&&(e=String(e)),void 0===e){var t=store.getUUID();store._state.identities.$identity_mp_id=t,store.set("distinct_id",t)}else validId(e)&&(store._state.identities.$identity_mp_id=e,store.set("distinct_id",e))}function trackSignup(e,t,i,a){var r,n,s,o;isObject(e)?(r=e.id,n=e.event_name,s=e.id_name):(r=e,n=t),store.set("distinct_id",r),o=s&&s!==IDENTITY_KEY.LOGIN?s+"+"+r:r,dataStage({original_id:store.getFirstId()||store.getDistinctId(),distinct_id:o,login_id:o,type:"track_signup",event:n,properties:i})}function login(e){if(!(e=validId(e)))return!1;if(isSameAndAnonymousID(e))return!1;var t=store.getFirstId(),i=store.getDistinctId(),a=IDENTITY_KEY.LOGIN;isNewLoginId(a,e)&&(store._state.identities[a]=e,store.set("history_login_id",{name:a,value:e}),t||store.set("first_id",i),sa.trackSignup({id:e,event_name:"$SignUp"}),store.identitiesSet({type:"login",id:e,id_name:a}))}function loginWithKey(e,t){if(log("loginWithKey is deprecated !!!"),!isString(e))return log("Key must be String"),!1;if(!check.checkKeyword(e)&&e.length>100)log("Key ["+e+"] is invalid");else if(!check.checkKeyword(e))return log("Key ["+e+"] is invalid"),!1;if(isPresetIdKeys(e,["$mp_openid","$identity_mp_openid","$identity_mp_unionid","$mp_unionid","$mp_id","$identity_mp_id"]))return log("Key ["+e+"] is invalid"),!1;if(!(t=validId(t)))return!1;if(isSameAndAnonymousID(t))return!1;var i=store.getFirstId(),a=store.getDistinctId();isNewLoginId(e,t)&&(store._state.identities[e]=t,store.set("history_login_id",{name:e,value:t}),i||store.set("first_id",a),sa.trackSignup({id:t,event_name:"$SignUp",id_name:e}),store.identitiesSet({type:"login",id:t,id_name:e}))}function getAnonymousID(){if(!isEmptyObject(store._state))return store._state._first_id||store._state.first_id||store._state._distinct_id||store._state.distinct_id;log("\u8bf7\u5148\u521d\u59cb\u5316SDK")}function getIdentities(){return isEmptyObject(store._state)?(log("\u8bf7\u5148\u521d\u59cb\u5316SDK"),null):store.getIdentities()||null}function logout(e){var t=store.getFirstId();store.identitiesSet({type:"logout"}),store.set("history_login_id",{name:"",value:""}),t?(store.set("first_id",""),!0===e?store.set("distinct_id",store.getUUID()):store.set("distinct_id",t)):log("\u6ca1\u6709first_id\uff0clogout\u5931\u8d25")}function getPresetProperties(){if(meta.preset_properties&&meta.preset_properties.$lib){var e={};each(meta.preset_properties,function(t,i){0===i.indexOf("$")&&(e[i]=t)});var t={$url_path:getCurrentPath(),$is_first_day:getIsFirstDay(),$is_first_time:meta.is_first_launch},i=extend(e,t,meta.preset_properties,store.getProps());return delete i.$lib,i}return{}}function bindOpenid(e){if(!(e=validId(e)))return!1;var t=getOpenidNameByAppid();this.bind(t,e)}function unbindOpenid(e){if(!validId(e))return!1;var t=getOpenidNameByAppid();this.unbind(t,e)}function setUnionid(e){log("setUnionid is deprecated !!!");var t=validId(e);t&&bind("$identity_mp_unionid",t)}function unsetUnionid(e){log("unsetUnionid is deprecated !!!");var t=validId(e);if(t){if(hasOwnProperty$3.call(store._state.identities,"$identity_mp_unionid")&&t===store._state.identities.$identity_mp_unionid){var i=getOpenidNameByAppid();hasOwnProperty$3.call(store._state.identities,i)&&(delete store._state.identities[i],delete store._state.openid,store.save())}unbind("$identity_mp_unionid",t)}}function bind(e,t){if(isNumber(t)){if(isInteger(t)&&!1===isSafeInteger(t))return log("Value must be String"),!1;t=String(t)}if(!isString(e))return log("Key must be String"),!1;var i=store.getHistoryLoginId(),a=i?i.name:"";return!check.checkKeyword(e)||isPresetIdKeys(e,[IDENTITY_KEY.LOGIN,a,"$mp_id","$identity_mp_id"])?(log("Key ["+e+"] is invalid"),!1):t&&""!==t?isString(t)?!!check.checkIdLength(t)&&(store._state.identities[e]=t,store.save(),void dataStage({type:"track_id_bind",event:"$BindID"})):(log("Value must be String"),!1):(log("Value is empty or null"),!1)}function unbind(e,t){if(isNumber(t)){if(isInteger(t)&&!1===isSafeInteger(t))return log("Value must be String"),!1;t=String(t)}if(!isString(e))return log("Key must be String"),!1;if(!sa._.check.checkKeyword(e)||isPresetIdKeys(e,[IDENTITY_KEY.LOGIN]))return log("Key ["+e+"] is invalid"),!1;if(!t||""===t)return log("Value is empty or null"),!1;if(!isString(t))return log("Value must be String"),!1;if(!sa._.check.checkIdLength(t))return!1;hasOwnProperty$3.call(store._state.identities,e)&&t===store._state.identities[e]&&("$mp_id"!==e&&"$identity_mp_id"!==e&&delete store._state.identities[e],store.save());var i=store.getDistinctId(),a=store.getFirstId();i===e+"+"+t&&(store.set("first_id",""),store.set("distinct_id",a),store.set("history_login_id",{name:"",value:""}));var r={};r[e]=t,dataStage({type:"track_id_unbind",event:"$UnbindID",unbind_value:r})}function setWebViewUrl(e,t){if(log("setWebViewUrl \u65b9\u6cd5\u5df2\u4ece 2022-9-23 \u5f00\u59cb\u5e9f\u5f03\uff0c\u8bf7\u5c3d\u5feb\u53bb\u9664\u8be5 API \u7684\u8c03\u7528\uff0c\u5e76\u4f7f\u7528 use \u63d2\u4ef6 \u4ee3\u66ff"),!isString(e)||""===e)return log("error:\u8bf7\u4f20\u5165\u6b63\u786e\u7684 URL \u683c\u5f0f"),!1;if(!/^http(s)?:\/\//.test(e))return log("warning: \u8bf7\u4f20\u5165\u6b63\u786e\u7684 URL \u683c\u5f0f"),!1;var i=/([^?#]+)(\?[^#]*)?(#.*)?/.exec(e);if(!i)return!1;var a,r=i[1]||"",n=i[2]||"",s=i[3]||"",o="",u=store.getDistinctId()||"",c=store.getFirstId()||"";urlSafeBase64&&urlSafeBase64.encode?u=u?urlSafeBase64.trim(urlSafeBase64.encode(urlBase64Encode(u))):"":rot13obfs&&(u=u?rot13obfs(u):""),u=encodeURIComponent(u);var p=c?"f"+u:"d"+u;t?(a=s.indexOf("_sasdk"),o=s.indexOf("?")>-1?a>-1?r+n+"#"+s.substring(1,a)+"_sasdk="+p:r+n+"#"+s.substring(1)+"&_sasdk="+p:r+n+"#"+s.substring(1)+"?_sasdk="+p):(a=n.indexOf("_sasdk"),o=/^\?(\w)+/.test(n)?a>-1?r+n.replace(/(_sasdk=)([^&]*)/gi,"_sasdk="+p)+s:r+"?"+n.substring(1)+"&_sasdk="+p+s:r+"?"+n.substring(1)+"_sasdk="+p+s);return o}function quick(){var e=arguments[0],t=arguments[1],i=arguments[2],a=isObject(i)?i:{};if("getAnonymousID"===e){if(!isEmptyObject(store._state))return store._state._first_id||store._state.first_id||store._state._distinct_id||store._state.distinct_id;log("\u8bf7\u5148\u521d\u59cb\u5316SDK")}else"appLaunch"===e||"appShow"===e?t?sa.autoTrackCustom[e](t,a):log("App\u7684launch\u548cshow\uff0c\u5728sensors.quick\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5fc5\u987b\u4f20\u5165App\u7684options\u53c2\u6570"):"appHide"===e&&(a=isObject(t)?t:{},sa.autoTrackCustom[e](a))}function appLaunch(e,t){var i={};e&&e.scene?(meta.current_scene=e.scene,i.$scene=getMPScene(e.scene)):i.$scene="\u672a\u53d6\u5230\u503c",e&&e.scene&&1010===e.scene&&e.query&&(e.query.sampshare&&delete e.query.sampshare,delObjectKey(e.query)),e&&e.path&&(i.$url_path=getPath(e.path),i.$title=getPageTitle(e.path)),setShareInfo(e,i);var a=setUtm(e,i);meta.is_first_launch?(i.$is_first_time=!0,isEmptyObject(a.pre1)||sa.setOnceProfile(a.pre1)):i.$is_first_time=!1,setLatestChannel(a.pre2),setSfSource(e,i),sa.registerApp({$latest_scene:i.$scene}),i.$url_query=setQuery(e.query),i.$url=e.path+(i.$url_query?"?"+i.$url_query:""),setPageRefData(t),isObject(t)&&(i=extend(i,t)),sa.track("$MPLaunch",i)}function appShow(e,t){var i={};meta.mp_show_time=(new Date).getTime(),e&&e.scene?(meta.current_scene=e.scene,i.$scene=getMPScene(e.scene)):i.$scene="\u672a\u53d6\u5230\u503c",e&&e.scene&&1010===e.scene&&e.query&&(e.query.sampshare&&delete e.query.sampshare,delObjectKey(e.query)),e&&e.path&&(i.$url_path=getPath(e.path),i.$title=getPageTitle(e.path)),setShareInfo(e,i),setLatestChannel(setUtm(e,i).pre2),setSfSource(e,i),sa.registerApp({$latest_scene:i.$scene}),i.$url_query=setQuery(e.query),e&&e.path&&(i.$url=e.path+(i.$url_query?"?"+i.$url_query:"")),setPageRefData(i,e.path,i.$url_query),isObject(t)&&(i=extend(i,t)),sa.track("$MPShow",i)}function appHide(e){var t=(new Date).getTime(),i={};i.$url_path=getCurrentPath(),meta.mp_show_time&&t-meta.mp_show_time>0&&(t-meta.mp_show_time)/36e5<24&&(i.event_duration=(t-meta.mp_show_time)/1e3),setPageRefData(i),isObject(e)&&(i=extend(i,e)),sa.track("$MPHide",i),sa.sendStrategy.onAppHide()}function pageShow(e){var t={},i=getCurrentPath(),a=getPageTitle(i),r=getCurrentPage();a&&(t.$title=a),t.$url_path=i,t.$url_query=r.sensors_mp_url_query?r.sensors_mp_url_query:"",setPageSfSource(t=extend(t,getUtmFromPage())),setPageRefData(t),isObject(e)&&(t=extend(t,e)),sa.track("$MPViewScreen",t)}function setPara(e){sa.para=extend2Lev(saPara,e);var t=[];if(isArray(saPara.source_channel))for(var i=saPara.source_channel.length,a=0;a<i;a++)-1===" utm_source utm_medium utm_campaign utm_content utm_term sa_utm ".indexOf(" "+saPara.source_channel[a]+" ")&&t.push(saPara.source_channel[a]);saPara.source_channel=t,isObject(saPara.register)&&extend(meta.preset_properties,saPara.register),saPara.openid_url||(saPara.openid_url=saPara.server_url.replace(/([^\\\/])\/(sa)(\.gif){0,1}/,"$1/mp_login")),"number"!=typeof saPara.send_timeout&&(saPara.send_timeout=1e3);var r={send_timeout:6e3,max_length:6};e&&e.datasend_timeout||saPara.batch_send&&(saPara.datasend_timeout=1e4),!0===saPara.batch_send?saPara.batch_send=extend({},r):isObject(saPara.batch_send)&&(saPara.batch_send=extend({},r,saPara.batch_send));var n={share:!1,utm:!1};!0===saPara.is_persistent_save?(saPara.is_persistent_save=extend({},n),saPara.is_persistent_save.utm=!0):isObject(saPara.is_persistent_save)&&(saPara.is_persistent_save=extend({},n,saPara.is_persistent_save)),saPara.server_url?(saPara.preset_properties=isObject(saPara.preset_properties)?saPara.preset_properties:{},isObject(saPara.autotrack_exclude_page)||(saPara.autotrack_exclude_page={pageShow:[],pageLeave:[]}),isArray(saPara.autotrack_exclude_page.pageShow)||(saPara.autotrack_exclude_page.pageShow=[]),isArray(saPara.autotrack_exclude_page.pageLeave)||(saPara.autotrack_exclude_page.pageLeave=[]),saPara.sdk_id&&(saPara.storage_store_key+=saPara.sdk_id,saPara.storage_prepare_data_key+=saPara.sdk_id)):log("\u8bf7\u4f7f\u7528 setPara() \u65b9\u6cd5\u8bbe\u7f6e server_url \u6570\u636e\u63a5\u6536\u5730\u5740,\u8be6\u60c5\u53ef\u67e5\u770bhttps://www.sensorsdata.cn/manual/mp_sdk_new.html#112-%E5%BC%95%E5%85%A5%E5%B9%B6%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0")}function getServerUrl(){return saPara.server_url}var autoTrackCustom={trackCustom:function(e,t,i){var a=saPara.autoTrack[e],r="";saPara.autoTrack&&a&&("function"==typeof a?isObject(r=a())&&extend(t,r):isObject(a)&&(extend(t,a),saPara.autoTrack[e]=!0),sa.track(i,t))},appLaunch:function(e,t){if(!checkPrivacyStatus())return!1;if(!meta.initialState.isComplete)return meta.initialState.queue.push(["appLaunch",arguments]),meta.life_state.app_launched=!0,!1;meta.life_state.app_launched=!0;var i={};if(e&&e.scene?(meta.current_scene=e.scene,i.$scene=getMPScene(e.scene)):i.$scene="\u672a\u53d6\u5230\u503c",e&&e.scene&&1010===e.scene&&e.query&&(e.query.sampshare&&delete e.query.sampshare,delObjectKey(e.query)),e&&e.path&&(i.$url_path=getPath(e.path),i.$title=getPageTitle(e.path),e.query&&isObject(e.query))){var a=setQuery(e.query);a=a?"?"+a:"",i.$url=i.$url_path+a}setShareInfo(e,i);var r=setUtm(e,i);meta.is_first_launch?(i.$is_first_time=!0,isEmptyObject(r.pre1)||sa.setOnceProfile(r.pre1)):i.$is_first_time=!1,setLatestChannel(r.pre2),setSfSource(e,i),sa.registerApp({$latest_scene:i.$scene}),i.$url_query=setQuery(e.query),setPageRefData(i),t?(i=extend(i,t),sa.track("$MPLaunch",i)):saPara.autoTrack&&saPara.autoTrack.appLaunch&&sa.autoTrackCustom.trackCustom("appLaunch",i,"$MPLaunch")},appShow:function(e,t){var i={};meta.mp_show_time=(new Date).getTime(),e&&e.scene?(meta.current_scene=e.scene,i.$scene=getMPScene(e.scene)):i.$scene="\u672a\u53d6\u5230\u503c",e&&e.scene&&1010===e.scene&&e.query&&(e.query.sampshare&&delete e.query.sampshare,delObjectKey(e.query)),e&&e.path&&(i.$url_path=getPath(e.path),i.$title=getPageTitle(e.path)),setShareInfo(e,i),setLatestChannel(setUtm(e,i).pre2),setSfSource(e,i),sa.registerApp({$latest_scene:i.$scene}),i.$url_query=setQuery(e.query),setPageRefData(i,e.path,i.$url_query),e&&e.path&&(i.$url=e.path+(i.$url_query?"?"+i.$url_query:"")),t?(i=extend(i,t),sa.track("$MPShow",i)):saPara.autoTrack&&saPara.autoTrack.appShow&&sa.autoTrackCustom.trackCustom("appShow",i,"$MPShow")},appHide:function(e){var t=(new Date).getTime(),i={};i.$url_path=getCurrentPath(),meta.mp_show_time&&t-meta.mp_show_time>0&&(t-meta.mp_show_time)/36e5<24&&(i.event_duration=(t-meta.mp_show_time)/1e3),setPageRefData(i),e?(i=extend(i,e),sa.track("$MPHide",i)):saPara.autoTrack&&saPara.autoTrack.appHide&&sa.autoTrackCustom.trackCustom("appHide",i,"$MPHide")},pageLoad:function(e){meta.current_scene&&1010===meta.current_scene&&e&&(e.sampshare&&delete e.sampshare,delObjectKey(e)),e&&isObject(e)&&(this.sensors_mp_url_query=setQuery(e),this.sensors_mp_encode_url_query=setQuery(e,!0))},pageShow:function(){meta.page_show_time=Date.now();var e={},t=getCurrentPath(),i=getPageTitle(t);setRefPage(),e.$url_path=t,e.$url_query=this.sensors_mp_url_query?this.sensors_mp_url_query:"",setPageRefData(e=extend(e,getUtmFromPage())),setPageSfSource(e),i&&(e.$title=i),saPara.onshow?saPara.onshow(sa,t,this):-1===saPara.autotrack_exclude_page.pageShow.indexOf(t)&&sa.autoTrackCustom.trackCustom("pageShow",e,"$MPViewScreen")},pageShare:function(e){var t=e.onShareAppMessage;e.onShareAppMessage=function(){var e=this;meta.share_method="\u8f6c\u53d1\u6d88\u606f\u5361\u7247";var i,a=t.apply(this,arguments);if(saPara.autoTrack&&saPara.autoTrack.pageShare){var r={$url_path:getCurrentPath(),$share_depth:meta.query_share_depth,$share_method:meta.share_method};setPageRefData(r),sa.autoTrackCustom.trackCustom("pageShare",r,"$MPShare")}function n(t){return isObject(t)||(t={}),(isUndefined(t.path)||""===t.path)&&(t.path=getCurrentUrl(e)),isString(t.path)&&(-1===t.path.indexOf("?")?t.path=t.path+"?":"&"!==t.path.slice(-1)&&(t.path=t.path+"&")),t.path=t.path+getShareInfo(),t}if(sa.para.allow_amend_share_path&&isObject(a=n(a)))for(var s in a)if((i=a[s])&&isFunction(i.then)&&isFunction(i.catch))try{a[s]=a[s].then(function(e){return n(e)})}catch(e){log("onShareAppMessage: "+e)}return a}},pageShareTimeline:function(e){var t=e.onShareTimeline;e.onShareTimeline=function(){meta.share_method="\u670b\u53cb\u5708\u5206\u4eab";var e=t.apply(this,arguments);if(saPara.autoTrack&&saPara.autoTrack.pageShare){var i={$url_path:getCurrentPath(),$share_depth:meta.query_share_depth,$share_method:meta.share_method};setPageRefData(i),sa.autoTrackCustom.trackCustom("pageShare",i,"$MPShare")}return saPara.allow_amend_share_path&&("object"!=typeof e&&(e={}),"object"==typeof e&&void 0===e.query&&(e.query=""),"object"==typeof e&&"string"==typeof e.query&&""!==e.query&&"&"!==e.query.slice(-1)&&(e.query=e.query+"&"),e.query=e.query+getShareInfo()),e}},pageAddFavorites:function(){var e={};e.$url_path=getCurrentPath(),saPara.autoTrack&&saPara.autoTrack.mpFavorite&&sa.autoTrackCustom.trackCustom("mpFavorite",e,"$MPAddFavorites")},pageHide:function(){sa.para.autoTrack&&sa.para.autoTrack.pageLeave&&sendPageLeave()}};function sendPageLeave(){var e={},t="";try{t=(e=getCurrentPage())?e.route:""}catch(e){log(e)}if(meta.page_show_time>=0&&""!==t){var i={},a=getPageTitle(t),r=(Date.now()-meta.page_show_time)/1e3;(isNaN(r)||r<0)&&(r=0),i.$url_query=e.sensors_mp_url_query?e.sensors_mp_url_query:"",i.$url_path=t,i.$title=a,i.event_duration=r,-1===saPara.autotrack_exclude_page.pageLeave.indexOf(t)&&sa.track("$MPPageLeave",i),meta.page_show_time=-1}}var functions=Object.freeze({__proto__:null,setProfile:setProfile,setOnceProfile:setOnceProfile,appendProfile:appendProfile,incrementProfile:incrementProfile,track:track,identify:identify,resetAnonymousIdentity:resetAnonymousIdentity,trackSignup:trackSignup,login:login,loginWithKey:loginWithKey,getAnonymousID:getAnonymousID,getIdentities:getIdentities,logout:logout,getPresetProperties:getPresetProperties,bindOpenid:bindOpenid,unbindOpenid:unbindOpenid,setUnionid:setUnionid,unsetUnionid:unsetUnionid,bindUnionid:setUnionid,unbindUnionid:unsetUnionid,bind:bind,unbind:unbind,setWebViewUrl:setWebViewUrl,quick:quick,appLaunch:appLaunch,appShow:appShow,appHide:appHide,pageShow:pageShow,setPara:setPara,getServerUrl:getServerUrl,sendPageLeave:sendPageLeave,autoTrackCustom:autoTrackCustom,registerApp:registerApp,register:register,clearAllRegister:clearAllRegister,clearAppRegister:clearAppRegister,clearAllProps:clearAllProps});function buildAPI(e){for(var t in functions)e[t]=functions[t]}function setFirstVisitTime(){meta.is_first_launch&&sa.setOnceProfile({$first_visit_time:new Date})}function checkIsComplete(){meta.initialState.isComplete=!0,meta.initialState.queue.length>0&&(each(meta.initialState.queue,function(e){"appLaunch"===e[0]?sa.autoTrackCustom.appLaunch.apply(sa.autoTrackCustom,slice.call(e[1])):sa[e[0]].apply(sa,slice.call(e[1]))}),meta.initialState.queue=[])}function init(e){if(!0===meta.init_status)return!1;function t(){checkIsComplete(),checkAppLaunch(),sa.ee.sdk.emit("ready")}meta.init_status=!0,sa.ee.sdk.emit("beforeInit"),e&&isObject(e)&&sa.setPara(e),sa.ee.sdk.emit("initPara"),sa.ee.sdk.emit("afterInitPara"),sa.store.init(),sa.checkPluginInitStatus(),setFirstVisitTime(),sa.para.batch_send&&sa.sendStrategy.init();var i=[getNetworkType(),getSystemInfo()].concat(meta.promise_list);Promise.all(i).then(()=>{t()}).catch(()=>{t()})}function registerPropertyPlugin(e){isFunction(e.properties)?!e.isMatchedWithFilter||isFunction(e.isMatchedWithFilter)?sa.ee.data.on("finalAdjustData",function(t){try{isFunction(e.isMatchedWithFilter)?e.isMatchedWithFilter(t)&&e.properties(t):e.properties(t)}catch(e){log("execute registerPropertyPlugin callback error:"+e)}}):log("registerPropertyPlugin arguments error, isMatchedWithFilter must be function"):log("registerPropertyPlugin arguments error, properties must be function")}sa._=_,sa.modules={},sa.meta=meta,sa.kit=kit,sa.mergeStorageData=mergeStorageData,sa.dataStage=dataStage,sa.sendStrategy=sendStrategy,sa.store=store,sa.usePlugin=usePlugin,sa.use=use,sa.checkPluginInitStatus=checkPluginInitStatus,sa.eventSub=eventSub,sa.events=new eventEmitter,sa.ee=ee,sa.registerPropertyPlugin=registerPropertyPlugin,sa.enableDataCollect=enableDataCollect,sa.initialState=meta.initialState,sa.IDENTITY_KEY={EMAIL:IDENTITY_KEY.EMAIL,MOBILE:IDENTITY_KEY.MOBILE},buildAPI(sa),apiStaging(),setNavigationBarTitle(),networkStatusChange(),initAppGlobalName(),initAppShowHide(),initPageProxy(),sa.init=init;var base={plugin_version:"1.21.5"};function createPlugin(e){if("object"==typeof e&&"string"==typeof e.plugin_name&&""!==e.plugin_name)return e.plugin_version=base.plugin_version,e.log=e.log||function(){"object"==typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)},e;"object"==typeof console&&"function"==typeof console.error&&console.error('plugin must contain  proprerty "plugin_name"')}var disableSDK={init(e){e.disableSDK=this.disableSDK.bind(this),e.enableSDK=this.enableSDK.bind(this),e.getDisabled=this.getDisabled.bind(this)},plugin_name:"DisableSDK",disabled:!1,disableSDK(){this.disabled=!0},enableSDK(){this.disabled=!1},getDisabled(){return this.disabled}},DisableSDK=createPlugin(disableSDK),oldOpenid={init(e){var t={getRequest:function(t){wx.login({success:function(i){i.code&&e.para.appid&&e.para.openid_url?e._.wxrequest({url:e.para.openid_url+"&code="+i.code+"&appid="+e.para.appid,method:"GET",complete:function(i){e._.isObject(i)&&e._.isObject(i.data)&&i.data.openid?t(i.data.openid):t()}}):t()}})},getWXStorage:function(){var t=e.store.getStorage();if(t&&e._.isObject(t))return t.openid},getOpenid:function(t){if(!e.para.appid)return t(),!1;var i=this.getWXStorage();i?t(i):this.getRequest(t)}};e.unsetOpenid=function(t){var i=e._.validId(t);if(!i)return!1;var a=e.store._state.openid;a===i&&e.store.set("openid","");var r=e._.getOpenidNameByAppid();if(Object.prototype.hasOwnProperty.call(e.store._state.identities,r)&&i===e.store._state.identities[r]){delete e.store._state.identities[r];var n=e.store.getFirstId(),s=e.store.getDistinctId(),o=e.store._state&&e.store._state.identities&&e.store._state.identities.$identity_mp_id;n&&n===a&&o&&e.store.change("first_id",o),s&&s===a&&o&&e.store.change("distinct_id",o),e.store.save()}},e.setOpenid=function(t){if(!(t=e._.validId(t)))return!1;if(!e.meta.init_status)return e.store.store_queue.push({method:"setOpenid",params:arguments}),!1;e.store.set("openid",t),e.identify(t);var i=e._.getOpenidNameByAppid();e.store._state.identities[i]=t,e.store.save()},e.initWithOpenid=function(i,a){(i=i||{}).appid&&(e.para.appid=i.appid),t.getOpenid(function(t){t&&e.setOpenid(t,i.isCoverLogin),a&&e._.isFunction(a)&&a(t),e.init(i)})}},plugin_name:"OldOpenid"},OldOpenid=createPlugin(oldOpenid),onceSend={init(e){e.kit.onceSend=function(t){t._flush_time=Date.now();var i=e.kit.onceTrackData(t),a=e.para.server_url+"?"+i;-1!==e.para.server_url.indexOf("?")&&(a=e.para.server_url+"&"+i),e._.wxrequest({url:a,method:"GET"})}},plugin_name:"OnceSend"},OnceSend=createPlugin(onceSend);sa.use(DisableSDK),sa.use(OldOpenid),sa.use(OnceSend),module.exports=sa;